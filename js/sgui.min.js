"use strict";let sgUiVersion="4.00.09",debugSG=!1,defaultRelTarget="#main",sgBoxPageCount=0,popStateCallback=!0,cameraPermission=!1;console.log("SG-UI Version "+sgUiVersion+" loaded");let isAndroidWebViewReady="object"==typeof Android,isFlutterInAppWebViewReady=!1;window.addEventListener("flutterInAppWebViewPlatformReady",function(e){isFlutterInAppWebViewReady=!0;window.flutter_inappwebview.callHandler("getCameraPermission").then(function(e){cameraPermission=e})}),$(document).on("click",'input[type="file"]',function(){if(console.log("<==== INPUT TYPE FILE CLICK"),console.log("JavaScript: Camera permission is ",cameraPermission),isFlutterInAppWebViewReady&&"PermissionStatus.denied"==cameraPermission){window.flutter_inappwebview.callHandler("requestCameraPermission").then(function(e){cameraPermission=e});return!1}});async function requestCameraPermission(){await window.flutter_inappwebview.callHandler("requestCameraPermission");return console.log("CAMERA PERMISSION (after) is ",cameraPermission),!!cameraPermission}function sgFindTargetElement(e,t){let a;return a="this"==e?t:"parent"==e?t.parent():e.match(/^parent /i)?t.closest(e.substring(7)):"before"==e?t.before():"after"==e?t.after():"prev"==e?t.prev():"next"==e?t.next():"box"==e?$("#cboxLoadedContent>.box-page").last():$(e),a}function sgShowBox(e,t,a,n){var o={fixed:!0,opacity:.5,width:"95%",maxHeight:"95%",maxWidth:"95%",className:"colorbox"+(t&&"full"==t.data("width")?" -full":""),onComplete:function(){}};let i=$("#cboxLoadedContent"),l,s=!1;var r=window.scrollX,d=window.scrollY;a=$.extend(o,a),t instanceof jQuery&&(s=!0,l=t.attr("href")?t.attr("href"):t.attr("action"),t.data("className")&&t.data("className",a.className+" "+t.data("className")),a=$.extend(a,t.data(),t.data("box"))),"boxwidth"in a&&(a.width=a.boxwidth),"boxheight"in a&&(a.height=a.boxheight),a.clearBoxContent&&(sgBoxPageCount=0,i.empty()),a.onClosed=function(){window.onscroll=function(){},sgBoxBack({close:!0})},window.onscroll=function(){window.scrollTo(r,d)},s&&"img"===t.data("rel")?(sgBoxPageCount=0,o=t.data("group"),a.open=!0,a.className=a.className+" -photo -full",$('.sg-action[data-group="'+o+'"]').each(function(e){let t=$(this);t.colorbox(a)}),t.colorbox(a),n.stopPropagation()):i.length?(debugSG&&console.log("Show Link In Current Box"),debugSG&&console.log("Link Url =",l),i.find(".box-page").hide(),sgBoxPageCount++,n='<div class="box-page" data-page="'+sgBoxPageCount+'" data-url="'+l+'">'+e+"</div>",i.append(n)):(sgBoxPageCount++,a.html='<div class="box-page" data-page="'+sgBoxPageCount+'" data-url="'+l+'">'+e+"</div>",$.colorbox(a)),history.pushState(null,document.title,"#box-"+sgBoxPageCount)}async function sgBoxBack(e={}){e=$.extend({close:null,historyBack:!0},e);let t=$("#cboxLoadedContent");$(".box-page");if(e.close){if(e.historyBack)for(let e=0;e<sgBoxPageCount;e++)history.back();t.length&&$.colorbox.close(),isAndroidWebViewReady&&Android.reloadWebView("Yes"),sgBoxPageCount=0}else 1===sgBoxPageCount?($.colorbox.close(),isAndroidWebViewReady&&Android.reloadWebView("Yes"),sgBoxPageCount=0,history.back()):1<sgBoxPageCount&&(t.children(".box-page").last().remove(),t.children(".box-page").last().show(),e.historyBack&&(popStateCallback=!1,await history.back(),popStateCallback=!0),sgBoxPageCount--)}function sgPopState(e){1===sgBoxPageCount?sgBoxBack({close:!0,historyBack:!1}):1<sgBoxPageCount&&sgBoxBack({historyBack:!1})}function sgUpdateData(e,t,a,n){var o,i,l;null!=t&&(l=(o=t.split(":"))[0],1<o.length&&(t=o[1]),debugSG&&console.log("Type = "+l+" Target = "+t),"none"==l||("console"==l?console.log(e):"notify"==l?notify("notify"!=t?t:e,2e4):"box"==l?(sgShowBox(e,a,{clearBoxContent:"clear"==t}),isAndroidWebViewReady&&Android.reloadWebView("No")):"close"==l?sgBoxBack({close:!0}):"reload"==l?window.location=document.URL:"this"==l?a.html(e):"parent"==l?(i="parent"==t?a.parent():a.closest(t)).html(e):"replace"==l?(i="replace"==t?a:a.closest(t).length?a.closest(t):$(t)).replaceWith(e):"after"==l?(i="after"==t?a:$(t)).after(e):"append"==l?(i="append"==t?a:$(t)).append(e):"refresh"==l?(l=(i="refresh"==t?$("#main"):$(t)).data("url")?i.data("url"):document.URL)&&$.post(l,function(e){i.html(e)}):$(t).html(e)))}window.addEventListener("popstate",function(e){sgPopState(e)});async function sgActionDone(doneData,$this,data,options={}){void 0!==doneData&&(doneData=doneData.replace(/\{\{(\w+)\}\}/g,function(e,t){return data[t]}),doneData.split("|").map(function(doneItem){var doneExplode=doneItem.trim().split(":"),doneType=doneExplode[0].split("->")[0],doneAction=doneExplode[0].split("->")[1],doneTarget=1<doneExplode.length?doneExplode[1].trim():"",moveto;switch(""==doneTarget&&(doneTarget="#main"),doneType){case"notify":notify(doneExplode[1],2e4);break;case"javascript":eval(doneTarget);break;case"function":let fn="(function "+doneTarget+")($this,data)";eval(fn);break;case"callback":var callback=doneTarget.trim();doneTarget&&"function"==typeof window[doneTarget]&&window[doneTarget]($this,data);break;case"back":sgBoxBack();break;case"close":sgBoxBack({close:!0});break;case"moveto":"#"===doneExplode[1].substr(0,1)?$(doneExplode[1]).length&&$("html,body").animate({scrollTop:$(doneExplode[1]).offset().top-$("#header-wrapper").height()-16},"slow"):(moveto=doneExplode[1].split(","),window.scrollTo(parseInt(moveto[0]),parseInt(moveto[1])));break;case"remove":var $ele=sgFindTargetElement(doneTarget,$this);$ele.remove();break;case"reload":setTimeout(function(){var e=(e=1<doneExplode.length?doneExplode[1]:document.URL).split("#")[0];window.location=e},200);break;case"load":setTimeout(function(){var t=sgFindTargetElement(doneTarget,$this),e=2<doneExplode.length?doneExplode[2]:t.data("url")?t.data("url"):document.URL;e&&(t.length||"none"==doneTarget)&&(e=e.split("#")[0],$.post(e,function(e){switch(doneAction){case"replace":t.replaceWith(e);break;case"before":t.before(e);break;case"after":t.after(e);break;case"append":t.append(e);break;case"prepend":t.prepend(e);break;case"prev":t.prev().html(e);break;case"next":t.next().html(e);break;case"clear":"box"==doneTarget&&sgShowBox(e,$this,{clearBoxContent:!0});break;default:t.html(e)}"box"==doneTarget&&$this.data("boxResize")&&$.fn.colorbox.resize({})}).fail(function(){console.log("Refresh url fail")}))},200)}}))}function sgWebViewDomProcess(e){e=$(e);sgActionDone(e.data("webviewResume"),e)}function drawChart(e){let t=$(e);var a=t.attr("id"),n=t.find("h3").text();let s=t.data("chartType"),o=$(e).find("table"),i=$(e).find(".widget-nav"),r=[],d=[],l={},c={},u=document.getElementById(a),p=null;null==s&&(s="col"),console.log("::SG-CHART "+s+" of "+a);let f={pointSize:4,allowHtml:!0,pieHole:.4,vAxis:{viewWindowMode:"explicit"},hAxis:{textStyle:{fontSize:10}},annotations:{textStyle:{fontSize:9}}};2==t.data("series")&&(f.series={0:{targetAxisIndex:0},1:{targetAxisIndex:1}}),l=$.extend(f,t.data("options")),t.data("value")||$.each(o.find("tbody>tr"),function(i,e){let t=$(this),l=[];$.each(t.find("td"),function(e,t){let a=$(this);var n=a.attr("class").split(":");let o;0==i&&d.push([n[0],n[1],null==n[2]?"":n[2]]),o="string"==n[0]?a.text():Number(a.text().replace(/[^\d\.]/g,"")),l.push(o),"guage"==s&&(c[a.attr("class")]=o)}),r.push(l)}),google.charts.load("current",{packages:["corechart","line","gauge"]}),google.charts.setOnLoadCallback(function(){n&&(l.title=n);let a=null;if(t.data("value"))a=google.visualization.arrayToDataTable(t.data("value"));else if("guage"==s){let t=[];t.push(["Label","Value"]),$.each(r,function(e){t.push([r[e][0],r[e][1]]),r[e][2]&&(l.max=r[e][2]),"redFrom"in c&&(l.redFrom=c.redFrom),"redTo"in c&&(l.redTo=c.redTo),"yellowFrom"in c&&(l.yellowFrom=c.yellowFrom),"yellowTo"in c&&(l.yellowTo=c.yellowTo),"greenFrom"in c&&(l.greenFrom=c.greenFrom),"greenTo"in c&&(l.greenTo=c.greenTo),"string:redColor"in c&&(l.redColor=c["string:redColor"])}),a=google.visualization.arrayToDataTable(t)}else a=new google.visualization.DataTable,$.each(d,function(e){"role"==d[e][2]?a.addColumn({type:d[e][0],role:"annotation"}):a.addColumn(d[e][0],d[e][1])}),a.addRows(r);"line"===s?p=new google.charts.Line(u):"bar"===s?p=new google.visualization.BarChart(u):"col"===s?p=new google.visualization.ColumnChart(u):"pie"===s?p=new google.visualization.PieChart(u):"combo"===s?p=new google.visualization.ComboChart(u):"guage"===s&&(p=new google.visualization.Gauge(u));{var e;!t.data("callback")||(e=t.data("callback"))&&"function"==typeof window[e]&&(e=window[e],google.visualization.events.addListener(p,"ready",e))}t.data("image")&&google.visualization.events.addListener(p,"ready",function(){var e=p.getImageURI();document.getElementById(t.data("image")).src=e});if(p.draw(a,l),i.length){let e=document.createElement("span");e.innerHTML=i.prop("outerHTML"),u.prepend(e)}})}!function(r){var a="0.03";r.fn.openWebview=function(e,t){let o=r(this),i=o.data(),l=o.attr("href");var s=o.data("webview");return self.doAction=function(){if(!isAndroidWebViewReady&&!isFlutterInAppWebViewReady)return!1;let t=JSON.stringify(i);var e,a,n;if("intent"==s)isFlutterInAppWebViewReady?(n=r.extend({actionBar:!1},o.data("options")),e=[l,i.webviewTitle,n],window.flutter_inappwebview.callHandler("openIntent",...e)):isAndroidWebViewReady&&Android.openBrowser(l,t);else if("browser"==s)isFlutterInAppWebViewReady?(n=r.extend({actionBar:!1},o.data("options")),e=[l,i.webviewTitle,n],window.flutter_inappwebview.callHandler("openBrowser",...e)):isAndroidWebViewReady&&Android.openBrowser(l,t);else if("googlemap"==s)isFlutterInAppWebViewReady?(a=[l,i],window.flutter_inappwebview.callHandler("openGoogleMap",...a)):isAndroidWebViewReady&&Android.openGoogleMap(l,t);else if("server"==s)debugSG&&console.log("Change to Server to "+i.server),isFlutterInAppWebViewReady?(a=[i.server],window.flutter_inappwebview.callHandler("useServer",...a)):isAndroidWebViewReady&&Android.useServer(i.server);else{if(!s)return!1;{let e=/^((http|https|ftp):\/\/)/;i.webviewTitle=i.webview,t=JSON.stringify(i),l=e.test(l)?l:document.location.origin+l,isFlutterInAppWebViewReady?(n=r.extend({actionBar:!0},o.data("options")),n=[l,i.webviewTitle,n],window.flutter_inappwebview.callHandler("showWebView",...n)):isAndroidWebViewReady&&Android.showWebView(l,t)}}},o.actionComplete=!1!==self.doAction(),o.version=function(){return console.log("$.sgAction version is "+a),o},o},r(document).on("click","[data-webview]",function(e){var t=r(this).openWebview(e,{}).actionComplete;return debugSG&&console.log("Mobile App WebView 0.03 result is ",t),!t||(e.stopImmediatePropagation(),!1)})}(jQuery),function($){var version="1.01",sgActionType="click",actionResult,debug;$.fn.sgAction=function(event,options={}){var $this=$(this),linkData=$this.data(),dataOptions=linkData.options,url=$this.attr("href"),relTarget=linkData.rel,retUrl=linkData.ret,para={},$boxElement=$("#cboxLoadedContent"),confirm=null==linkData.confirm||linkData.confirmed,callback=linkData.callback,relAction,doneResult;"javascript:void(0)"==url&&(url=linkData.url),console.log("$.sgAction version "+version+" start"),relTarget&&(relAction=relTarget.split("->")[1],relTarget=relTarget.split("->")[0]);var defaults={result:"html",container:$(this),loadurl:linkData.loadurl,silent:!1,callback:!1},settings=$.extend({},$.fn.sgAction.defaults,defaults,dataOptions,options);return self.doAction=async function(){if(console.log("relTarget = "+relTarget+" Action = "+relAction),confirm){if(linkData.confirmed&&($this.removeData("confirmed"),para.confirm="yes"),"box"==relTarget&&"clear"==relAction&&(sgBoxPageCount=0,$boxElement.empty()),linkData.before&&sgActionDone(linkData.before,$this),"close"==relTarget){if(0!=$this.closest(".sg-dropbox.box").length)return $(".sg-dropbox.box").children("div").hide(),void $(".sg-dropbox.box.active").removeClass("active");if($("#cboxLoadedContent").length)return void sgBoxBack({close:!0});if(isFlutterInAppWebViewReady)return void window.flutter_inappwebview.callHandler("closeWebView");if(isAndroidWebViewReady)return void Android.closeWebView();relTarget=void 0}else{if("back"==relTarget&&$boxElement.length)return void history.back();if("img"==relTarget)return void sgShowBox(null,$this,null,event)}if(null==relTarget&&null==retUrl){let hasPara="{}"!=JSON.stringify(para),hrefUrl=$this.attr("href");return hrefUrl+=hasPara?(-1==hrefUrl.indexOf("?")?"?":"&")+$.param(para):"",window.location=hrefUrl,!0}if(url&&"#"==url.substr(0,1)){let html=null;return"#"!=url&&$(url).length&&(html=$(url).get(0).innerHTML),sgUpdateData(html,relTarget,$this),void sgActionDone(linkData.done,$this,doneResult)}if(debugSG&&console.log("Load from url "+url),settings.silent||notify(settings.indicator),"iframe"==$this.data("type"))return sgShowBox('<iframe src="'+url+'"></iframe>',$this,{clearBoxContent:"clear"==relTarget}),void notify("");let urlMatch=url.match(/^(function|javascript)\:(.*)/);if(urlMatch){let urlFunction=urlMatch[2];if("javascript"===urlMatch[1])eval(urlFunction);else{let exeFunction=window[urlFunction];await exeFunction($this).then(function(){notify(),sgActionDone(linkData.done,$this,doneResult)})}}else $.post(url,para,function(e){var t;doneResult=e,notify(),settings.silent||console.log("Load completed."),retUrl?(debugSG&&console.log("Return URL "+retUrl),$.post(retUrl,function(e){sgUpdateData(e,relTarget,$this),notify()})):sgUpdateData(e,relTarget,$this),linkData.removeparent&&((t=linkData.removeparent).charAt(0).match(/\.|\#/i)?$(t):$this.closest(t)).remove(),settings.callback&&settings.callback($this,e),callback&&"function"==typeof window[callback]?window[callback]($this,e):callback&&(window.location=callback)}).done(function(e){e.responseCode&&e.text&&notify(e.text,3e3),sgActionDone(linkData.done,$this,doneResult)}).fail(function(e){let t="ERROR : ";e.responseJSON.text?t+=e.responseJSON.text:t+=e.statusText,t+=" ("+e.status+")",notify(t,3e3)})}},self.test=function(){console.log("THIS IS A TEST")},$this.actionResult=!1!==self.doAction(),$this.version=function(){return console.log("$.sgAction version is "+version),$this},$this},$.fn.sgForm=function(){return this},$.fn.sgAction.defaults={indicator:"LOADING",tooltip:"คลิกเพื่อแก้ไข",cssclass:"inlineedit",width:"none",height:"none",cancelcssclass:"btn -link -cancel",submitcssclass:"btn -primary",showButtonPanel:!0,event:"edit",inputcssclass:""},$(document).on(sgActionType,".sg-action",function(e){return!$(this).sgAction(e,{aTestOpt:"This is test option"}).actionResult})}(jQuery),$(document).on("submit","form.sg-form",function(a){var n,o=$(this),i=o.data("rel"),l=o.data("ret"),s=o.data("complete"),e=o.data("checkvalid"),r=o.data("onformsubmit"),t=o.data("silent"),d="",c="";return console.log("sg-form :: Submit"),(!e||(console.log("Form Check input valid start."),o.find(".require, .-require").each(function(e){var t=$(this);if("text"!=t.attr("type")&&"password"!=t.attr("type")&&"hidden"!=t.attr("type")&&"TEXTAREA"!=t.prop("tagName")||""!=t.val().trim()?"SELECT"!=t.prop("tagName")||0!=t.val()&&-1!=t.val()&&""!=t.val()?"radio"!=t.attr("type")&&"checkbox"!=t.attr("type")||$("input[name='"+t.attr("name")+"']:checked").val()||(c=(d=t).closest("div").children("label").first().text()):(d=t,c='กรุณาเลือกข้อมูลในช่อง " '+$("label[for="+d.attr("id")).text()+' "'):(d=t,c='กรุณาป้อนข้อมูลในช่อง " '+$("label[for="+d.attr("id")).text()+' "',t.focus()),d){t=d.attr("id");return $("#"+t).isOnScreen()||$("html,body").animate({scrollTop:d.offset().top-100},"slow"),notify(c),!1}}),!d))&&(r&&"function"==typeof window[r]?new Promise((e,t)=>window[r](a,this)):null==i||(t||notify("PROCESSING"),debugSG&&console.log("Send form to "+o.attr("action")),debugSG&&console.log("Result to "+i),o.hasClass("-upload")?(debugSG&&console.log("SOFTGANZ UPLAOD FILE"),o.ajaxSubmit({success:function(e){debugSG&&console.log("SG-FORM.-UPLOAD ajaxSubmit upload file complete."),"remove"==s?o.remove():"close"!=s&&"closebox"!=s||(0!=$(a.rel).closest(".sg-dropbox.box").length?($(".sg-dropbox.box").children("div").hide(),$(".sg-dropbox.box.active").removeClass("active")):sgBoxBack()),l?$.post(l,function(e){sgUpdateData(e,i,o),notify(),sgActionDone(o.data("done"),o,e)}):(sgUpdateData(e,i,o),sgActionDone(o.data("done"),o,n)),"notify"!=i&&notify(),o.replaceWith(o.clone(!0))},error:function(e){notify(e.statusText),debugSG&&console.log(e),sgUpdateData(e.responseText,i,o)}})):$.post(o.attr("action"),o.serialize(),function(e){n=e,debugSG&&console.log("Form submit completed and send output to "+i),"remove"==s?o.remove():"close"!=s&&"closebox"!=s||(0!=$(a.rel).closest(".sg-dropbox.box").length?($(".sg-dropbox.box").children("div").hide(),$(".sg-dropbox.box.active").removeClass("active")):sgBoxBack({close:!0})),l?(debugSG&&console.log("Return URL "+l),$.post(l,function(e){sgUpdateData(e,i,o),notify()})):(sgUpdateData(e,i,o),o.data("moveto")&&(t=o.data("moveto").split(","),window.scrollTo(parseInt(t[0]),parseInt(t[1])))),"notify"!=i.substring(0,6)&&notify();var t=o.data("callback");t&&"function"==typeof window[t]?window[t](o,e):t&&(window.location=t)},null==o.data("dataType")?null:o.data("dataType")).fail(function(e){let t="ERROR : ";return e.responseJSON.text?t+=e.responseJSON.text+" ("+e.status+")":t+=e.statusText+" ("+e.status+")",notify(t),debugSG&&console.log(e),!1}).done(function(e){e.responseCode&&e.text&&notify(e.text,3e3),sgActionDone(o.data("done"),o,n)}),!1))}).on("keydown","form.sg-form input:text",function(e){var t=$(this).closest("form").find("input:text"),a=t.length;if(13==e.keyCode){if(e.preventDefault(),"submit"==t.attr("onEnter"))return t.closest("form").submit(),!1;e=t.index(this)+1;return e<a&&t[e].focus(),!1}}),function(d){let c=0,u=0,p,f;d.fn.sgInlineEdit=function(t,n={}){if(void 0!==d.fn.editable){if("disable"!==t&&"enable"!==t&&"destroy"!==t){let a=d(this),i=a.closest(".sg-inline-edit"),l=a.data("updateUrl"),e=a.data("type");var o=a.data("callback");if(void 0===l&&(l=i.data("updateUrl")),p=!!i.data("debug"),"money"==e||"numeric"==e||"text-block"==e)e="text";else if("radio"==e||"checkbox"==e)f=a.is(":checked")?a.attr("value"):"";else{if("link"==e)return;""!=e&&null!=e||(e="text",a.data("type","text"))}var r={type:e,result:"json",container:d(this),onblur:a.data("onblur")?a.data("onblur"):"submit",data:function(e,t){return a.data("data")?a.data("data"):null!=a.data("value")?a.data("value"):"..."==e?"":e},loadurl:a.data("loadurl"),before:function(){let e=a.data("options");var t=null!=e&&e.hasOwnProperty("onBefore")?e.onBefore:null;t&&"function"==typeof window[t]&&window[t](a,i)},cancel:"yes"==d(this).data("button")?'<button class="btn -link -cancel"><i class="icon -material -gray">cancel</i><span>ยกเลิก</span></button>':null,submit:"yes"==d(this).data("button")?'<button class="btn -primary"><i class="icon -material -white">done_all</i><span>บันทึก</span></button>':null,placeholder:d(this).data("placeholder")?d(this).data("placeholder"):"..."},t=a.data("options");let s=d.extend({},d.fn.sgInlineEdit.defaults,r,n,t);return t&&"debug"in t&&t.debug&&(p=!0),"textarea"==a.data("type")?s.inputcssclass="form-textarea":"text"==a.data("type")?s.inputcssclass="form-text":"numeric"==a.data("type")?s.inputcssclass="form-text -numeric":"money"==a.data("type")?s.inputcssclass="form-text -money":"email"==a.data("type")?s.inputcssclass="form-text -email":"url"==a.data("type")?s.inputcssclass="form-text -url":"autocomplete"==a.data("type")?s.inputcssclass="form-text -autocomplete":"select"==a.data("type")&&(s.inputcssclass="form-select"),self._validValue=function(e,t){return"numeric"!=e.data("ret")||(t=t.replace(/[^0-9.\-]+|\.(?!\d)/g,""),!(null!=e.data("minValue")&&+t<+e.data("minValue"))&&!(null!=e.data("maxValue")&&+t>+e.data("maxValue")))},self.save=function(o,e,t){if(void 0!==l){let n=d.extend({},i.data(),o.data());delete n.options,delete n.data,delete n["event.editable"],delete n.uiAutocomplete,n.action="save",n.value=e.replace(/\"/g,'"'),s.var&&(n[s.var]=n.value),o.data("value",n.value),c++,u++,notify("กำลังบันทึก กรุณารอสักครู่...."+(p?"<br />Updating : pending = "+c+" To = "+l+"<br />":"")),i.find(".inline-edit-field").addClass("-disabled"),d.post(l,n,function(t){var e;if(c--,i.find(".inline-edit-field").removeClass("-disabled"),"string"==typeof t&&(e=t,(t={}).value=n.value,p&&(t.msg=e)),"refresh"==n.ret)window.location=window.location;else if("autocomplete"==o.data("type"))o.data("value",n.value),o.html("<span>"+t.value+"</span>");else if("radio"!=o.data("type")&&"checkbox"!=o.data("type"))if("select"==o.data("type")){let e;e=o.data("data")?o.data("data")[t.value]:t.value,o.html("<span>"+e+"</span>")}else o.html("<span>"+(null==t.value?'<span class="placeholder -no-print">'+s.placeholder+"</span>":t.value)+"</span>");let a="";n.tr!=t.tr&&(0==t.tr&&(t.tr=""),d('[data-group="'+n.group+'"]').data("tr",t.tr),a="Replace tr of group "+n.group+" with "+t.tr),notify((t.error||t.msg||"")+(p&&t.debug?'<div class="-sg-text-left" style="white-space: normal;">Update queue = '+u+", Update pending = "+c+"<br />PARAMETER : group = "+n.group+", FIELD = "+n.fld+", TRAN = "+n.tr+", VALUE = "+t.value+"<br />DEBUG : "+t.debug+"<br />Return : TRAN = "+t.tr+"<br />"+a+"</div>":""),p?3e5:5e3)},s.result).fail(function(e){notify("ERROR ON POSTING. Please Contact Admin.")}).done(function(e){var t=s.callback||o.data("callback");debugSG&&console.log("CALLBACK ON COMPLETE -> "+t+(t?"()":"")),t&&("function"==typeof window[t]?window[t](o,e,i):"silent"==s.callbackType?d.get(t,function(){}):window.location=t),s.done&&sgActionDone(s.done,o,e),console.log("$.sgInlineEdit DONE!!!")})}else notify("ข้อมูลปลายทางสำหรับบันทึกข้อมูลผิดพลาด")},"radio"==e||"checkbox"==e?self.save(a,f,o):a.editable(function(e,t){return _validValue(a,e)?(self.save(a,e,o),e):(notify("ข้อมูลไม่อยู่ในช่วงที่กำหนด"),a.data("value"))},s).trigger("edit"),{getVersion:function(){return"1.01"},update:function(e,t,a){self.save(e,t,a)}}}}else console.log("ERROR :: $.editable is not load")},d.fn.sgInlineEdit.defaults={indicator:'<div class="loader -rotate"></div>',indicator:"SAVING",tooltip:"คลิกเพื่อแก้ไข",cssclass:"inlineedit",width:"none",height:"none",var:null,cancelcssclass:"btn -link -cancel",submitcssclass:"btn -primary",showButtonPanel:!0,event:"edit",inputcssclass:"",autocomplete:{},datepicker:{}},d(document).on("click",".sg-inline-edit .inline-edit-field:not(.-readonly)",function(){console.log("$.sgInlineEdit version 1.01 start"),d(this).sgInlineEdit()}),d(document).on("keydown",".sg-inline-edit .inline-edit-field",function(a){if(9==a.keyCode){let e=d(this);e.closest(".sg-inline-edit");let t="";a=d(".inline-edit-field").index(this);return t=a==d(".inline-edit-field").length-1?d(".inline-edit-field:first"):d(".inline-edit-field").eq(a+1),d(this).find("input").blur(),d(t).trigger("click"),!1}})}(jQuery),function(p){let f=0,g=0,h=0;p.fn.sgInlineEdit2=function(e,o={}){if(void 0!==p.fn.editable){if("disable"!==e&&"enable"!==e&&"destroy"!==e){h++;let t=p(this),n=t.closest(".inlineedit-field"),l=t.closest(".sg-inlineedit"),s=n.data("type");var i=n.data("callback"),c=n.data("options"),e=c&&"button"in c||"yes"==n.data("button");let a=n.data("action")?n.data("action"):n.data("updateUrl");let r=!1;if(void 0===a&&(a=l.data("action")?l.data("action"):l.data("updateUrl")),"money"==s||"numeric"==s||"text-block"==s)s="text";else if("radio"!=s&&"checkbox"!=s){if("link"==s)return;""!=s&&null!=s||(s="text",n.data("type","text"))}e={type:s,result:"json",onblur:n.data("onblur")?n.data("onblur"):"submit",data:function(e,t){return n.data("data")?n.data("data"):null!=n.data("value")?n.data("value"):"..."==e?"":e},loadurl:n.data("loadurl"),before:function(){let e=n.data("options");var t=null!=e&&e.hasOwnProperty("onBefore")?e.onBefore:null;t&&"function"==typeof window[t]&&window[t](n,l)},cancel:e?'<button class="btn -link -cancel"><i class="icon -material -gray">cancel</i><span>ยกเลิก</span></button>':null,submit:e?'<button class="btn -primary"><i class="icon -material -white">done_all</i><span>บันทึก</span></button>':null,placeholder:n.data("placeholder")?n.data("placeholder"):"..."};let d=p.extend({},p.fn.sgInlineEdit.defaults,e,o,l.data("options"),n.data("options"),t.data("options"));if(r=!!l.data("debug"),c&&"debug"in c&&c.debug&&(r=!0),r=d.debug,"textarea"==s?d.inputcssclass="form-textarea":"text"==s?d.inputcssclass="form-text":"numeric"==s?d.inputcssclass="form-text -numeric":"money"==s?d.inputcssclass="form-text -money":"email"==s?d.inputcssclass="form-text -email":"url"==s?d.inputcssclass="form-text -url":"autocomplete"==s?d.inputcssclass="form-text -autocomplete":"select"==s&&(d.inputcssclass="form-select"),self._validValue=function(e,t){return"numeric"!=e.data("ret")||(t=t.replace(/[^0-9.\-]+|\.(?!\d)/g,""),!(null!=e.data("minValue")&&+t<+e.data("minValue"))&&!(null!=e.data("maxValue")&&+t>+e.data("maxValue")))},self.save=function(o,e,t){if(void 0!==a){let n=p.extend({},l.data(),o.data());var i=n.retType||n.ret;delete n.updateUrl,delete n.options,delete n.data,delete n["event.editable"],delete n.uiAutocomplete,delete n.rel,delete n.done,n.action="save",n.value="string"==typeof e?e.replace(/\"/g,'"'):e,o.data("inputName")&&(n[o.data("inputName")]=e),d.var&&(n[d.var]=n.value),o.data("value",n.value),f++,g++,notify("กำลังบันทึก กรุณารอสักครู่...."+(r?"<br />Updating : pending = "+f+" To = "+a+"<br />":"")),p.post(a,n,function(t){var e;if(f--,l.find(".inlineedit-field").removeClass("-disabled"),"string"==typeof t&&(e=t,(t={}).value=n.value,r&&(t.msg=e)),"refresh"==i)window.location=window.location;else if("autocomplete"==s)o.data("value",n.value),o.find("form").replaceWith(t.value);else if("radio"!=s&&"checkbox"!=s&&"select"==s){let e;e=o.data("data")?o.data("data")[t.value]:t.value,o.find("form").replaceWith(e)}let a="";n.tr!=t.tr&&(0==t.tr&&(t.tr=""),p('[data-group="'+n.group+'"]').data("tr",t.tr),a="Replace tr of group "+n.group+" with "+t.tr),notify(("error"in t?t.error:"msg"in t?t.msg:"บันทึกเรียบร้อย")+(r?'<div class="-sg-text-left" style="white-space: normal;">Update queue = '+g+", Update pending = "+f+"<br /><b>POST PARAMETER:</b><pre>"+JSON.stringify(n,null,"\t")+"</pre><b>RETURN VALUE:</b><pre>"+JSON.stringify(t,null,2).replace(/\\n/g,"<br>").replace(/\\t/g,"  ").replace(/\\/g,"")+"</pre><br />"+a+"</div>":""),r?3e5:5e3)},d.result).fail(function(e){notify("ERROR ON POSTING. Please Contact Admin.")}).done(function(e){var t=d.callback||o.data("callback");debugSG&&console.log("CALLBACK ON COMPLETE -> "+t+(t?"()":"")),t&&("function"==typeof window[t]?window[t](o,e,l):"silent"==d.callbackType?p.get(t,function(){}):window.location=t),d.done&&sgActionDone(d.done,o,e),console.log("$.sgInlineEdit DONE!!!")})}else notify("ข้อมูลปลายทางสำหรับบันทึกข้อมูลผิดพลาด (ไม่ได้ระบุ)")},"radio"==s){var u=t.attr("value");self.save(n,u,i)}else if("checkbox"==s)if("array"===n.data("jsonType")){let e=t.closest(".inlineedit-field").find("input:checked"),a=[];e.each(function(e,t){a.push(p(this).attr("value"))}),self.save(n,a,i)}else{u=t.attr("value");self.save(n,u,i)}else t.editable(function(e,t){return _validValue(n,e)?(self.save(n,e,i),e):(notify("ข้อมูลไม่อยู่ในช่วงที่กำหนด"),n.data("value"))},d).trigger("edit");return{getVersion:function(){return"2.00"},update:function(e,t,a){self.save(e,t,a)}}}}else console.log("ERROR :: $.editable is not load")},p.fn.sgInlineEdit.defaults={indicator:'<div class="loader -rotate"></div>',indicator:"SAVING",tooltip:"คลิกเพื่อแก้ไข",cssclass:"inlineedit",width:"none",height:"none",var:null,cancelcssclass:"btn -link -cancel",submitcssclass:"btn -primary",showButtonPanel:!0,event:"edit",inputcssclass:"",autocomplete:{},datepicker:{}},p(document).on("click",".sg-inlineedit .inlineedit-field:not(.-readonly) .-for-input",function(){console.log("$.sgInlineEdit version 2.00 start"),p(this).sgInlineEdit2()}),p(document).on("keydown",".sg-inlineedit .inlineedit-field",function(a){if(9==a.keyCode){let e=p(this);e.closest(".sg-inlineedit");let t="";a=p(".inlineedit-field").index(this);return t=a==p(".inlineedit-field").length-1?p(".inlineedit-field:first"):p(".inlineedit-field").eq(a+1),p(this).find("input").blur(),p(t).trigger("click"),!1}}),p(document).ready(function(){void 0!==p.fn.editable&&(p.editable.addInputType("checkbox",{}),p.editable.addInputType("radio",{}),p.editable.addInputType("autocomplete",{element:p.editable.types.text.element,plugin:function(i,l){p(l).attr("autocomplete","off");var e={target:"",source:function(e,t){var a=i.autocomplete.query;let n={};n.q=e.term,p.get(a,n,function(e){t(p.map(e,function(e){return e}))},"json")},minLength:2,dataType:"json",cache:!1,focus:function(e,t){e.preventDefault()},select:function(e,t){this.value=t.item.label;let a=i.autocomplete.target;if(a)for(var n in"string"==typeof a&&(a=JSON.parse('{"'+a+'": "value"}')),a){var o=t.item[a[n]];"#"==n.substring(0,1)||"."==n.substring(0,1)?p(n).val(t.item.value):p(l).data(n,o)}p(this).submit()}};i.autocomplete=p.extend({},e,i.autocomplete),p("input",this).autocomplete(i.autocomplete).autocomplete("instance")._renderItem=function(e,t){return("..."==t.value?p('<li class="ui-state-disabled -more"></li>').append(t.label):p("<li></li>").append("<a><span>"+t.label+"</span>"+(null!=t.desc?"<p>"+t.desc+"</p>":"")+"</a>")).appendTo(e)}}}),p.editable.addInputType("datepicker-old",{element:function(e,t){let a=p('<input class="form-text -datepicker" />');return a.attr("autocomplete","off"),e.datepicker?a.datepicker(e.datepicker):a.datepicker(),e.datepicker.format&&a.datepicker("option","dateFormat",e.datepicker.format),p(this).append(a),a},submit:function(e,t){var a=p("input",this).datepicker("getDate");let n;n=e.datepicker.format?p.datepicker.formatDate(e.datepicker.format,new Date(a)):a,p("input",this).val(n)},plugin:function(e,t){e.onblur="submit"}}),p.editable.addInputType("datepicker",{element:function(e,t){let a=p('<input class="form-text -datepicker" />');a.attr("autocomplete","off");var n={format:"dd/mm/yy",monthNames:thaiMonthName,beforeShow:function(e){console.log("INLINE DATE BEFORE SHOW"),p(".ui-datepicker:visible").css({top:"+=5"})},open:function(){console.log("INLINE DATEOPEN"),p(".ui-datepicker:visible").css({top:"+=5"})},onSelect:function(){p(this).submit()}};return e.datepicker=p.extend({},n),a.datepicker(e.datepicker),e.datepicker.format&&a.datepicker("option","dateFormat",e.datepicker.format),p(this).append(a),a},submit:function(e,t){var a=p("input",this).datepicker("getDate");let n;n=null===a?null:e.datepicker.format?p.datepicker.formatDate(e.datepicker.format,new Date(a)):a,n?p("input",this).val(n):p("input",this).val(""),p("input",this).datepicker("hide")},plugin:function(e,t){e.onblur="nothing"}}))})}(jQuery),function(a){a(document).on("click",".sg-expand",function(){let e=a(this),t=a(this).children();if(e.data("rel"))a(e.data("rel")).toggle();else{let e=a(this).closest(".widget-listtile");e.next().toggle()}"expand_less"==t.text()?t.text("expand_more"):"expand_more"==t.text()?t.text("chevron_right"):"chevron_right"==t.text()&&t.text("expand_more")})}(jQuery),function(c){var u="0.10";let l=0;c.fn.sgDrawReport=function(e,t={}){let a=c(this),n=a.closest("form"),s=a.closest(".sg-drawreport");var o=s.data("query"),i=s.data("callback"),l=s.data("options");console.log("$.sgDrawReport version 0.10 init");var r={dataType:"json",container:c(this),callback:!1},d=c.extend({},c.fn.sgDrawReport.defaults,r,l,t);return self.startDrawReport=function(a){console.log("$.sgDrawReport 0.10 start draw report");0<s.find('input[name="debug"]:checked').length&&a.process;if("html"!=d.dataType){let t=s.find("#report-output-debug").empty();a.debug&&a.process&&a.process.forEach(function(e){t.append(c("<div></div>").html(e))}),s.data("showChart")&&showChart(a),s.data("showSummary")&&showSummary(a),s.data("showItems")&&showItems(a),s.data("showHtml")&&showHtml(a)}else{let e=c(s.data("showHtml"));e.html(a)}},self.showChart=function(e){var t=c(s.data("showChart")),a=s.find("#graphtype").val();let n=[["รายการ","จำนวน"]];console.log("graphType = ",a),null!=e.summary&&0!=t.length&&(e.summary.forEach(function(e,t){n.push([e.label,e.project])}),t=google.visualization.arrayToDataTable(n),e={title:e.title,hAxis:{title:"H Axis",titleTextStyle:{color:"black"}},vAxis:{title:"Y Axis",minValue:0},isStacked:!1},new("Bar"==a?google.visualization.BarChart:"Col"==a?google.visualization.ColumnChart:"Line"==a?google.visualization.LineChart:google.visualization.PieChart)(document.getElementById("report-output-chart")).draw(t,e))},self.showSummary=function(t){var o,a,n,e=c(s.data("showSummary"));e.empty(),null!=t.summary&&0!=e.length&&(o=c("<table></table>").addClass("widget-table"),a=c("<thead></thead>"),Object.keys(t.summaryFields).forEach(function(e){a.append(c("<th></th>").text(t.summaryFields[e]))}),o.append(a),t.summary.forEach(function(a,e){var n=c("<tr></tr>").addClass("row");Object.keys(t.summaryFields).forEach(function(e){let t=a[e];"number"==typeof t&&parseInt(t)!=t&&(t=thousandsSeparators(t)),n.append(c("<td></td>").addClass("col "+("label"==e?"":"-center")).text(t))}),o.append(n)}),t.total&&(n=c("<tfoot></tfoot").append(c("<tr></tr>")),Object.keys(t.summaryFields).forEach(function(e){"label"==e?n.append("<td>รวมทั้งสิ้น</td>"):"%"==t.summaryFields[e]?n.append(c("<td></td>").addClass("col -center").text("100%")):n.append(c("<td></td>").addClass("col -center").text(t.total[e]))}),o.append(n)),e.append(o))},self.showItems=function(i){let e=c(s.data("showItems"));var t,a,l;e.empty(),null!=i.items&&0!=e.length&&0<i.items.length&&((t=c("<a/>")).addClass("btn").html('<i class="icon -material">cloud_download</i><span>EXPORT</span>').attr("href","javascript:void(0)").attr("onClick",'export2excel("trans")'),e.append(c("<nav></nav>").addClass("nav -page -table-export -sg-text-right").append(t)),t=c("<table></table>").addClass("widget-table").attr("id","detail-list"),a=c("<thead></thead>").append(c("<tr></tr>")),Object.keys(i.itemsFields).forEach(function(e){a.append(c("<th></th>").text(i.itemsFields[e]))}),t.append(a),l=c("<tbody></tbody>"),i.items.forEach(function(t,e){let a=c("<tr></tr>").addClass("row"),n=c("<a/>"),o;"object"==typeof t.config.link&&(o=t.config.link.field,n.attr("href",t.config.link.href).text(t[t.config.link.field]).addClass("sg-action").attr("target","_blank").data("rel","box").data("width",640).data("webview",t.fullname)),Object.keys(i.itemsFields).forEach(function(e){a.append(c("<td></td>").html(e==o?n:t[e]))}),l.append(a)}),t.append(l),e.append(t))},self.showHtml=function(e){let t=c(s.data("showHtml"));t.empty(),null!=e.html&&t.html(e.html)},a.doAction=function(){a.hasClass("-submit-group")?(a.closest("ul").children().removeClass("-active"),a.closest("li").addClass("-active"),c("#reporttype").val(a.attr("href").slice(1))):a.hasClass("-graph")&&c("#graphtype").val(a.val());var t=c(".report-output").css("opacity");return c(".report-output").css("opacity",.5),c.post(o,n.serialize(),function(e){notify()},d.dataType).fail(function(e){notify("ERROR ON POSTING")}).done(function(e){c(".report-output").css("opacity",t),debugSG&&e.debug&&console.log("DONE WITH data = ",e),i&&"function"==typeof window[i]?window[i](a,e):startDrawReport(e)}),null!=e&&"checkbox"!=c(e.target).attr("type")&&e.preventDefault(),a},a.showChart=function(e){return showChart(e),a},a.showSummary=function(e){return showSummary(e),a},a.showItems=function(e){return showItems(e),a},a.showHtml=function(e){return showHtml(e),a},a.version=function(){return console.log("$.sgDrawReport version is "+u),a},a.makeFilterBtn=function(){let t=s.find("#toolbar-report-filter>.-item");t.empty(),c(".sg-drawreport .-filter-checkbox:checked").each(function(e){t.append('<span class="" data-src="'+c(this).attr("id")+'">'+c(this).closest("label").text()+'<a class="x-submit"><i class="icon -material -sg-16">close</i></a></span>')})},a},c.fn.sgDrawReport.defaults={indicator:"LOADING"},c(document).on("click",".sg-drawreport>form>.toolbar.-report>.-filter>.-select>.-item a",function(){var e=c(this).closest("span").data("src");c("#"+e).prop("checked",!1);let t=c("#"+e).closest("li").find(".-amt");t.html(t.text()-1);c(this).sgDrawReport(event,{aTestOption:"This is test option"}).doAction();c(this).parent().remove()}),c(document).on("click",".sg-drawreport .-submit",function(e){return c(this).sgDrawReport(e,{aTestOption:"This is test option"}).doAction()}),c(document).on("change",".sg-drawreport .-filter-checkbox",function(){let t=0;c(this).closest(".-checkbox").find(".-filter-checkbox:checked").each(function(e){t++}),c(this).closest("li").find(".-check-count>.-amt").html(t).parent().removeClass("-hidden").addClass(0<t?"":"-hidden"),c(this).sgDrawReport().makeFilterBtn()}),c(document).on("click",".sg-drawreport .group-nav",function(){let e=c(this);var t=e.hasClass("-left");let a=e.closest(".-group");var n=a.width()-60,o=a.find("ul>li").width(),i=Math.floor(n/o),n=Math.ceil(a.find("ul").width()/n);t?0<l&&l--:l<n-1&&l++;i=l*o*i+(i*l+1)-1;a.find("ul").animate({left:-i+"px"},"fast")})}(jQuery),$(document).on("click",".widget-tabbar>.tabs>li>a, .sg-tabs>.ui-tab>.ui-item>a, .sg-tabs>ul.tabs>li>a, .sg-tabs>ul>li>a",function(e){var t=$(this),a=t.closest(".sg-tabs"),n=t.attr("href");if(t.closest("ul").children("li").removeClass("-active"),t.closest("li").addClass("-active"),null!=t.attr("target"))return!0;null==n||"javascript:void(0)"==n||("#"==n.left(1)?(a.children("div").hide(),a.children(t.attr("href")).show()):t.hasClass("sg-action")||(notify("LOADING"),$.post(n,function(e){a.children("div").html(e),notify()})));n=t.data("callback");return n&&"function"==typeof window[n]?window[n](t,html):n&&(window.location=n),!1}),$(document).on("click",".sg-dropbox>a",function(){var e=$(this).parent(),t=$(this).next(),a=e.find(".sg-dropbox--content");$(".sg-dropbox.click").not($(this).parent()).each(function(){$(this).children("div").hide()}),"box"==e.data("type")?(e.css("display","block").addClass("active"),null!=e.data("url")?(a.html("LOADING"),t.show(),$.get(e.data("url"),function(e){a.html(e)})):t.show()):"click"==e.data("type")?t.show():t.toggle();var n=$(this).offset(),o=t.width(),i=$(document).width(),e=0;return n.left+o>i&&(e=i-n.left-$(this).width()-8,t.css({rightside:e+"px"})),!1}).on("click","body",function(e){0==$(e.target).closest(".sg-dropbox").length&&$(".sg-dropbox.click").children("div").hide(),0===$(e.target).closest(".sg-dropbox.box").length&&($(".sg-dropbox.box").children("div").hide(),$(".sg-dropbox.box.active").removeClass("active"))}),$(document).on("focus",".sg-datepicker",function(e){console.log("SG-DATEPICKER Start"),$(this).attr("autocomplete","off");var t={clickInput:!0,dateFormat:"dd/mm/yy",altFormat:"yy-mm-dd",altField:"AAAA",disabled:!1,monthNames:thaiMonthName,beforeShow:function(e){$(this).data("previous",$(e).val()),$(".ui-datepicker:visible").css({top:"+=5"})},open:function(){},onSelect:function(o,e){if($(this).data("previous")!=o){if($(this).data("diff")){let n=$("#"+$(this).data("diff")),e=$(this);if(""==n.val())n.val(e.val());else{var i=0;let e=$(this).data("previous")?$(this).data("previous"):o;var l=e.split("/"),s=$(this).val().split("/"),r=n.val().split("/"),l=new Date(l[2],l[1]-1,l[0]),r=new Date(r[2],r[1]-1,r[0]);let t=new Date(s[2],s[1]-1,s[0]);i=Math.round((r-l)/864e5);let a=new Date(t);a.setDate(t.getDate()+i);r=a.getDate(),l=a.getMonth()+1,i=a.getFullYear(),i=("00"+r).slice(-"00".length)+"/"+("00"+l).slice(-"00".length)+"/"+i;n.val(i)}}$(this).trigger("dateupdated")}i=$(this).data("callback");i&&("submit"==i?$(this).closest("form").submit():"function"==typeof window[i]?window[i](o,$(this)):(i=i+"/",window.location=i))}},t=$.extend(t,$(this).data());$(this).datepicker(t)}),$(document).on("focus",".sg-address",function(e){var n=$(this);n.autocomplete({source:function(e,t){$.get(url+"api/address?q="+encodeURIComponent(e.term),function(e){t(e)},"json")},minLength:6,dataType:"json",cache:!1,select:function(e,t){this.value=t.item.label,n.data("altfld")&&$("#"+n.data("altfld")).val(t.item.value);var a=n.data("callback");return a&&("submit"==a?$(this).closest("form").trigger("submit"):"function"==typeof window[a]?window[a](n,t):(t=a+"/"+t.item.value,window.location=t)),!1}}).autocomplete("instance")._renderItem=function(e,t){return("..."==t.value?$('<li class="ui-state-disabled -more"></li>').append(t.label):$("<li></li>").append("<a><span>"+t.label+"</span>"+(null!=t.desc?"<p>"+t.desc+"</p>":"")+"</a>")).appendTo(e)}}),$(document).on("focus",".sg-autocomplete",function(e){var l=$(this),s=l.closest("form"),t=1;l.data("minlength")&&(t=l.data("minlength")),l.autocomplete({minLength:t,dataType:"json",cache:!1,source:function(e,t){var a={};a.n=l.data("item"),a.q=l.val(),notify("กำลังค้นหา"),$.get(l.data("query"),a,function(e){notify(),t(e);e=l.data("renderComplete");if(e&&"function"==typeof window[e])return window[e](l)},"json")},open:function(){$(".ui-autocomplete:visible").css({top:"+=5"}),l.data("class")&&l.autocomplete("widget").addClass(l.data("class")),l.data("width")&&l.autocomplete("widget").css({width:l.data("width")})},focus:function(e,t){return!1},select:function(e,t){var a;if(l.data("altfld")&&(a="#"+l.data("altfld"),(s.find(a).length?s.find(a):$(a)).val(t.item.value)),null!=l.data("select")){var n,o=l.data("select");if("object"==typeof o)for(n in o)$("#"+n).val(t.item[o[n]]);else"string"==typeof o&&l.val(t.item[o])}else l.val(t.item.label);let i=l.data("callback");return i&&("submit"==i?$(this).closest("form").trigger("submit"):"function"==typeof window[i]?window[i](l,t):(a=i.match(/\?/i)?"":"/",a=i+a+t.item.value,window.location=a)),!1},response:function(e,t){var a=l.data("renderStart");a&&"function"==typeof window[a]&&window[a](l,t)}}).autocomplete("instance")._renderItem=function(e,t){var a=l.data("renderItem");return a&&"function"==typeof window[a]?window[a](l,e,t):("..."==t.value?$('<li class="ui-state-disabled -more"></li>').append(t.label):$("<li></li>").append("<a><span>"+(null!=t.altLabel?t.altLabel:t.label)+"</span>"+(null!=t.desc?"<p>"+t.desc+"</p>":"")+"</a>")).appendTo(e)}}),$(document).on("change","form.sg-upload .inline-upload",function(){var e,t,a,n=$(this),o=n.closest("form"),i=o.data("rel"),l=' class="'+(null!=o.data("class")?o.data("class"):"ui-item -hover-parent")+'"';isAndroidWebViewReady&&Android.showToast("กำลังอัพโหลดไฟล์"),console.log("sg-upload :: Inline upload file start and show result in "+i),o.data("before")?(t="<"+(e=o.data("before"))+l+'><div class="loader -rotate -center"></div></'+e+">",a=n.closest(e).before(t)):notify('<div class="loader -rotate"></div> กำลังอัพโหลดไฟล์ กรุณารอสักครู่'),o.ajaxForm({success:function(e){var t;isAndroidWebViewReady&&Android.showToast("อัพโหลดไฟล์เรียบร้อบ"),i&&(o.data("append")?(t="<"+o.data("append")+l+">"+e+"</"+o.data("append")+">",$(i).append(t)):o.data("prepend")?(t="<"+o.data("prepend")+l+">"+e+"</"+o.data("prepend")+">",$(i).prepend(t)):o.data("before")?a.prev().html(e):o.data("after")?(t="<"+o.data("after")+l+">"+e+"</"+o.data("after")+">",n.closest(o.data("after")).after(t)):sgUpdateData(e,i,n)),notify("ดำเนินการเสร็จแล้ว.",5e3),n.val(""),n.replaceWith(n.clone(!0)),sgActionDone(o.data("done"),o,e)}}).submit()}),$(document).ready(function(){$(".sg-chart").each(function(e){drawChart(this)})});let sgDrawMap=function(n,e={}){var o,i=$.extend({},{gisDigit:14,zoom:9,center:[],drag:"pin",dropPin:!1,dropPinText:null,updateUrl:null,updatePara:null,updateIcon:null,mapCanvas:"#map-canvas",height:"100%",pin:[],markers:[],address:[],done:null,debug:!1,callback:!1},e);i.debug&&console.log(i);var t=$("#current-location .value"),a=i.updateUrl,l=!!i.pin.lat,s="",r=a?("map"==i.drag?"เลื่อนแผนที่":"ลากหมุด")+"เพื่อเปลี่ยนตำแหน่ง":"";$(".box-page").css({width:"100%",height:"100%",minWidth:"100%",minHeight:"100%"}),$(".page.-map").css({height:i.height,minWidth:"100%",minHeight:i.height}),$(i.mapCanvas).css({width:"100%",height:"100%",minWidth:"100%",minHeight:"100%"}),i.dropPin?l?notify(r,2e4):!l&&i.updateUrl&&notify("คลิกบนแผนที่ตรงตำแหน่งที่ต้องการวางหมุด",2e4):l=!0;var d=new GMaps({div:i.mapCanvas,zoom:i.zoom,scrollwheel:!0,lat:i.center.lat,lng:i.center.lng,click:function(e){i.updateUrl&&(l||(notify(r,2e4),o=e.latLng.lat().toFixed(i.gisDigit)+","+e.latLng.lng().toFixed(i.gisDigit),u=f({lat:e.latLng.lat(),lng:e.latLng.lng()}),l=!0,new google.maps.InfoWindow({content:s}).open(d,u),t.text(o)))}});"map"==i.drag&&d.addListener("center_changed",()=>{u&&(u.setPosition(d.getCenter()),p(d.getCenter().lat(),d.getCenter().lng()))});function c(n){if(null==a)return!1;var e=null==i.updatePara?{}:i.updatePara;e.location=n,i.debug&&console.log("SAVE Location "+a,e),$.post(a,e,function(e){var t="https://www.google.com/maps/place/"+n,a="geo:?q="+n;$("#googlemap").attr("href",t).removeClass("-hidden"),$("#googlenav").attr("href",a).removeClass("-hidden");a=""!=n?"-active":"";i.updateIcon&&$(i.updateIcon).removeClass("-active").addClass(a)}).fail(function(e){notify(e.responseJSON.text,3e3)}).done(function(e){notify(e.text,3e3),sgActionDone(i.done,null,n)})}var u;function p(e,t){var a=$("#current-location");a.find(".value").text(e.toFixed(i.gisDigit)+","+t.toFixed(i.gisDigit)),a.find(".show").text(e.toFixed(4)+","+t.toFixed(4))}function f(e){o=e.lat.toFixed(i.gisDigit)+","+e.lng.toFixed(i.gisDigit);var t='<nav class="nav -sg-flex"><a class="sg-action btn -link -cancel" href="#current-location" data-rel="none" data-title="ลบหมุด" data-confirm="ลบหมุด กรุณายืนยัน?" data-done="javascript:'+n+'.clearMap()"><i class="icon -material">cancel</i><span>ลบหมุด</span></a><a class="btn -primary" onClick=\''+n+'.locationUpdate($("#current-location>.value").text());return false;\'><i class="icon -material">done</i><span>บันทึกตำแหน่ง</span></a></nav>',a="";return e.currentLocation&&null!=i.locationText?a=i.locationText:i.pin&&null!=i.pin.content&&(a=i.pin.content),s='<div class="map-info">'+a+(i.updateUrl?t:"")+'<div id="current-location" class="current-location">พิกัด <span class="value -hidden">'+o+'</span><span class="show">'+e.lat.toFixed(4)+","+e.lng.toFixed(4)+'</span>\x3c!-- TODO:: <a class="btn -link" style="padding: 2px 4px 2px 8px; margin-left: 8px;" onClick=\''+n+'.editLocation($("#current-location>.value").text());return false;\'><i class="icon -material -sg-16">edit</i><span>แก้ไข</span></a> --\x3e</div></div>',d.addMarker({lat:e.lat,lng:e.lng,draggable:!!i.updateUrl&&"map"!=i.drag,infoWindow:{title:i.pin.title,content:s},dragend:function(e){p(e.latLng.lat(),e.latLng.lng())}})}return i.pin.lat&&i.pin.lng&&(u=f(i.pin),new google.maps.InfoWindow({content:s}).open(d,u)),i.markers&&$.each(i.markers,function(e,t){t.lat&&t.lng&&d.addMarker({lat:t.lat,lng:t.lng,draggable:null!=t.draggable&&t.draggable,icon:null==t.icon?"https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=|CCCCCC|FFFFFF":t.icon,infoWindow:{content:null==t.content?"":t.content}})}),i.address&&$.each(i.address,function(a,n){GMaps.geocode({address:n,callback:function(e,t){"OK"==t&&(e=e[0].geometry.location,l||0!=a||d.setCenter(e.lat(),e.lng()),d.addMarker({lat:e.lat(),lng:e.lng(),icon:"https://softganz.com/library/img/geo/circle-green.png",infoWindow:{content:n}}))}})}),$("#getgis").click(function(){return notify("กำลังหาตำแหน่งปัจจุบัน"),navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){notify(),d.setCenter({lat:e.coords.latitude,lng:e.coords.longitude}),null==u&&(u=f({lat:e.coords.latitude,lng:e.coords.longitude,currentLocation:!0}),new google.maps.InfoWindow({content:s}).open(d,u),l=!0),u.setPosition(d.getCenter()),p(e.coords.latitude,e.coords.longitude)},function(e){notify("Error: The Geolocation service failed.",5e3)},{timeout:7e3,enableHighAccuracy:!0,maximumAge:0}):notify("Error: Browser doesnt support Geolocation.",5e3),!1}),{clearMap:function(){l=!1,c(""),u.setMap(null)},locationUpdate:c,editLocation:function(e){if(null==a)return!1},currentMarker:function(){return o},settings:i}};$(document).on("change",".sg-changwat",function(){var e=$(this),t=e.closest("form"),a=(t.find(".sg-changwat"),t.find(".sg-ampur")),n=t.find(".sg-tambon"),o=t.find(".sg-village"),i=e.data("altfld");""==e.val()?a.val("").hide():a.val(""),n.val("").hide(),o.length&&o.val("").hide(),a.length&&(a[0].options.length=1),n.length&&(n[0].options.length=1),o.length&&(o[0].options.length=1),i&&t.find(i).val(e.val()),$.get(url+"api/ampur",{q:e.val()},function(e){e.length?a.show():a.hide();for(var t=0;t<e.length;t++)a.append($("<option></option>").text(e[t].label).val(e[t].ampur))},"json"),"submit"==e.data("change")&&t.submit()}),$(document).on("change",".sg-ampur",function(){var e=$(this),t=e.closest("form"),a=t.find(".sg-changwat"),n=t.find(".sg-ampur"),o=t.find(".sg-tambon"),i=t.find(".sg-village"),l=e.data("altfld");""==e.val()?o.val("").hide():o.val(""),i.val("").hide(),o.length&&(o[0].options.length=1),i.length&&(i[0].options.length=1),l&&t.find(l).val(a.val()+e.val()),$.get(url+"api/tambon",{q:a.val()+n.val()},function(e){e.length?o.show():o.hide();for(var t=0;t<e.length;t++)o.append($("<option></option>").text(e[t].label).val(e[t].tambon))},"json"),"submit"==e.data("change")&&t.submit()}),$(document).on("change",".sg-tambon",function(){let e=$(this),t=e.closest("form"),a=t.find(".sg-changwat"),n=t.find(".sg-ampur"),o=t.find(".sg-tambon"),i=t.find(".sg-village");var l=e.data("altfld");l&&t.find(l).val(a.val()+n.val()+e.val()),i.length&&(""==e.val()?i.val("").hide():i.val("").show(),i.length&&(i[0].options.length=1),$.get(url+"api/village",{q:a.val()+n.val()+o.val()},function(t){for(let e=0;e<t.length;e++)i.append($("<option></option>").text(t[e].label).val(t[e].village))},"json"),"submit"==e.data("change")&&t.submit())}),$(document).on("change",".sg-village",function(){var e=$(this),t=e.closest("form"),a=t.find(".sg-changwat"),n=t.find(".sg-ampur"),o=t.find(".sg-tambon");t.find(".sg-village");a.data("altfld")&&$(a.data("altfld")).val(a.val()+n.val()+o.val()+e.val()),"submit"==e.data("change")&&t.submit()}),$(document).on("click",'.widget-table>thead>tr>th[class*="-sort-"]',function(e){notify("Sorting!!! Please wait...",100),console.log("TABLE SORT START"),$(this).closest("thead").find("th").removeClass("-order"),$(this).addClass("-order"),$(this).closest("table").attr("id")&&($(this).prevAll().length,console.log("TABLE SORT END"))});