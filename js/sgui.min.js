"use strict";let sgUiVersion="4.00.19",debugSG=!1,defaultRelTarget="#main",sgBoxPageCount=0,popStateCallback=!0,cameraPermission=!1,isAndroidWebViewReady="object"==typeof Android,isFlutterInAppWebViewReady=!1;async function requestCameraPermission(){await window.flutter_inappwebview.callHandler("requestCameraPermission");return!!cameraPermission}import("./deprecated/sgui.inlineedit.v1.js"),window.addEventListener("flutterInAppWebViewPlatformReady",(function(e){isFlutterInAppWebViewReady=!0;window.flutter_inappwebview.callHandler("getCameraPermission").then((function(e){cameraPermission=e}))})),window.addEventListener("popstate",(function(e){sgPopState(e)})),$(document).on("click",'input[type="file"]',(function(){if(isFlutterInAppWebViewReady&&"PermissionStatus.denied"==cameraPermission){window.flutter_inappwebview.callHandler("requestCameraPermission").then((function(e){cameraPermission=e}));return!1}}));class SG{static url(e){return ENV.rootUrl+e}}function sgFindTargetElement(e,t){let a;return a="this"==e?t:"parent"==e?t.parent():e.match(/^parent /i)?t.closest(e.substring(7)):"before"==e?t.before():"after"==e?t.after():"prev"==e?t.prev():"next"==e?t.next():"box"==e?$("#cboxLoadedContent>.box-page").last():$(e),a}function sgShowBox(e,t,a,n){let o,i={fixed:!0,opacity:.5,width:"95%",maxHeight:"95%",maxWidth:"95%",className:"colorbox"+(t&&["full","appbar"].includes(t.data("width"))?" -"+t.data("width"):""),onCleanup:async function(){let e=$(".box-page[data-page=1]"),t=e.data("done");t&&await sgActionDone(t,e)},onComplete:function(){}},l=$("#cboxLoadedContent"),s=!1,r=window.scrollX,d=window.scrollY;a=$.extend(i,a),t instanceof jQuery&&(s=!0,o=t.attr("href")?t.attr("href"):t.attr("action"),t.data("className")&&t.data("className",a.className+" "+t.data("className")),a=$.extend(a,t.data(),t.data("box"))),"boxwidth"in a&&(a.width=a.boxwidth),"boxheight"in a&&(a.height=a.boxheight),a.clearBoxContent&&(sgBoxPageCount=0,l.empty()),a.onClosed=function(){window.onscroll=function(){},sgBoxBack({close:!0})},window.onscroll=function(){window.scrollTo(r,d)};let c=t.data("boxClose")?' data-done="'+t.data("boxClose")+'"':"";if(s&&"img"===t.data("rel")){sgBoxPageCount=0;let e=t.data("group");a.open=!0,a.className=a.className+" -photo -full",$('.sg-action[data-group="'+e+'"]').each((function(e){$(this).colorbox(a)})),t.colorbox(a),n.stopPropagation()}else if(l.length){l.find(".box-page").hide(),sgBoxPageCount++;let t='<div class="box-page" data-page="'+sgBoxPageCount+'" data-url="'+o+'"'+c+">"+e+"</div>";l.append(t)}else sgBoxPageCount++,a.html='<div class="box-page" data-page="'+sgBoxPageCount+'" data-url="'+o+'"'+c+">"+e+"</div>",$.colorbox(a);history.pushState(null,document.title,"#box-"+sgBoxPageCount)}async function sgBoxBack(e={}){e=$.extend({close:null,historyBack:!0},e);let t=$("#cboxLoadedContent");$(".box-page");if(e.close){if(sgBoxPageCount){if(e.historyBack)for(let e=0;e<sgBoxPageCount;e++)history.back();$.colorbox.close()}else isFlutterInAppWebViewReady?window.flutter_inappwebview.callHandler("closeWebView"):isAndroidWebViewReady&&Android.reloadWebView("Yes");sgBoxPageCount=0}else 1===sgBoxPageCount?($.colorbox.close(),isAndroidWebViewReady&&Android.reloadWebView("Yes"),sgBoxPageCount=0,history.back()):sgBoxPageCount>1&&(t.children(".box-page").last().remove(),t.children(".box-page").last().show(),e.historyBack&&(popStateCallback=!1,await history.back(),popStateCallback=!0),sgBoxPageCount--)}function sgPopState(e){1===sgBoxPageCount?sgBoxBack({close:!0,historyBack:!1}):sgBoxPageCount>1&&sgBoxBack({historyBack:!1})}function sgUpdateData(e,t,a,n={}){if(null==t)return;let o,i=t.split(":"),l=i[0];if(i.length>1&&(t=i[1]),"none"==l);else if("console"==l);else if("notify"==l)notify("notify"!=t?t:e,2e4);else if("box"==l)sgShowBox(e,a,{clearBoxContent:"clear"==t}),isAndroidWebViewReady&&Android.reloadWebView("No");else if("close"==l)sgBoxBack({close:!0});else if("reload"==l)window.location=document.URL;else if("this"==l)a.html(e);else if("parent"==l)o="parent"==t?a.parent():a.closest(t),o.html(e);else if("replace"==l)o="replace"==t?a:a.closest(t).length?a.closest(t):$(t),o.replaceWith(e);else if("after"==l)o="after"==t?a:$(t),o.after(e);else if("append"==l)o="append"==t?a:$(t),o.append(e);else if("refresh"==l){o="refresh"==t?$("#main"):$(t);let e=o.data("url")?o.data("url"):document.URL;e&&$.post(e,(function(e){o.html(e)}))}else $(t).html(e)}async function sgActionDone(doneData,$this,data,options={}){void 0!==doneData&&(doneData=doneData.replace(/\{\{(\w+)\}\}/g,(function(e,t){return data[t]})),doneData.split("|").map((function(doneItem){const doneExplode=doneItem.trim().split(":").map((e=>e.trim())),doneCommand=doneExplode[0].split("->")[0].trim(),doneOption=doneExplode[0].split("->")[1]?doneExplode[0].split("->")[1].trim():null;let doneTarget=doneExplode.length>1?doneExplode[1].trim():"";switch(""==doneTarget&&(doneTarget="#main"),doneCommand){case"notify":notify(doneExplode[1],2e4);break;case"javascript":eval(doneTarget);break;case"function":let fn="(function "+doneTarget+")($this,data)";eval(fn);break;case"callback":let callback=doneTarget.trim();doneTarget&&"function"==typeof window[doneTarget]&&window[doneTarget]($this,data);break;case"back":sgBoxBack();break;case"close":sgBoxBack({close:!0});break;case"moveto":if("#"===doneExplode[1].substr(0,1))$(doneExplode[1]).length&&$("html,body").animate({scrollTop:$(doneExplode[1]).offset().top-$("#header-wrapper").height()-16},"slow");else{let e=doneExplode[1].split(",");window.scrollTo(parseInt(e[0]),parseInt(e[1]))}break;case"remove":let $ele=sgFindTargetElement(doneTarget,$this);$ele.remove();break;case"reload":setTimeout((function(){let e=doneExplode.length>1?doneExplode[1]:document.URL;e=e.split("#")[0],window.location=e}),200);break;case"load":setTimeout((function(){let e=sgFindTargetElement(doneTarget,$this),t=doneExplode.length>2?doneExplode[2]:e.data("url")?e.data("url"):document.URL;t&&(e.length||"none"==doneTarget)&&(t=t.split("#")[0],$.post(t,(function(e){})).done((t=>{switch(doneOption){case"replace":e.replaceWith(t);break;case"before":e.before(t);break;case"after":e.after(t);break;case"append":e.append(t);break;case"prepend":e.prepend(t);break;case"prev":e.prev().html(t);break;case"next":e.next().html(t);break;case"clear":"box"==doneTarget&&sgShowBox(t,$this,{clearBoxContent:!0});break;default:e.html(t);break}"box"==doneTarget&&$this.data("boxResize")&&$.fn.colorbox.resize({})})).fail((function(){})))}),200);break}})))}function sgWebViewDomProcess(e){let t=$(e);sgActionDone(t.data("webviewResume"),t)}function drawChart(e){let t=$(e),a=t.attr("id"),n=t.find("h3").text(),o=t.data("chartType"),i=$(e).find("table"),l=$(e).find(".widget-nav"),s=[],r=[],d={},c={},u=document.getElementById(a),p=null;null==o&&(o="col");let f={pointSize:4,allowHtml:!0,pieHole:.4,vAxis:{viewWindowMode:"explicit"},hAxis:{textStyle:{fontSize:10}},annotations:{textStyle:{fontSize:9}}};2==t.data("series")&&(f.series={0:{targetAxisIndex:0},1:{targetAxisIndex:1}}),d=$.extend(f,t.data("options")),t.data("value")||$.each(i.find("tbody>tr"),(function(e,t){let a=$(this),n=[];$.each(a.find("td"),(function(t,a){let i,l=$(this),s=l.attr("class").split(":");0==e&&r.push([s[0],s[1],null==s[2]?"":s[2]]),i="string"==s[0]?l.text():Number(l.text().replace(/[^\d\.]/g,"")),n.push(i),"guage"==o&&(c[l.attr("class")]=i)})),s.push(n)})),google.charts.load("current",{packages:["corechart","line","gauge"]}),google.charts.setOnLoadCallback((function(){n&&(d.title=n);let e=null;if(t.data("value"))e=google.visualization.arrayToDataTable(t.data("value"));else if("guage"==o){let t=[];t.push(["Label","Value"]),$.each(s,(function(e){t.push([s[e][0],s[e][1]]),s[e][2]&&(d.max=s[e][2]),"redFrom"in c&&(d.redFrom=c.redFrom),"redTo"in c&&(d.redTo=c.redTo),"yellowFrom"in c&&(d.yellowFrom=c.yellowFrom),"yellowTo"in c&&(d.yellowTo=c.yellowTo),"greenFrom"in c&&(d.greenFrom=c.greenFrom),"greenTo"in c&&(d.greenTo=c.greenTo),"string:redColor"in c&&(d.redColor=c["string:redColor"])})),e=google.visualization.arrayToDataTable(t)}else e=new google.visualization.DataTable,$.each(r,(function(t){"role"==r[t][2]?e.addColumn({type:r[t][0],role:"annotation"}):e.addColumn(r[t][0],r[t][1])})),e.addRows(s);"line"===o?p=new google.charts.Line(u):"bar"===o?p=new google.visualization.BarChart(u):"col"===o?p=new google.visualization.ColumnChart(u):"pie"===o?p=new google.visualization.PieChart(u):"combo"===o?p=new google.visualization.ComboChart(u):"guage"===o&&(p=new google.visualization.Gauge(u));if(t.data("callback")){let e=t.data("callback");if(e&&"function"==typeof window[e]){let t=window[e];google.visualization.events.addListener(p,"ready",t)}}t.data("image")&&google.visualization.events.addListener(p,"ready",(function(){let e=p.getImageURI();document.getElementById(t.data("image")).src=e}));if(p.draw(e,d),l.length){let e=document.createElement("span");e.innerHTML=l.prop("outerHTML"),u.prepend(e)}}))}!function(e){e.fn.openWebview=function(t,a={}){let n=e(this),o=n.data(),i=n.attr("href"),l=n.data("webview");return self.doAction=function(){if(!isAndroidWebViewReady&&!isFlutterInAppWebViewReady)return!1;let t=JSON.stringify(o);if("intent"==l)if(isFlutterInAppWebViewReady){let t=e.extend({actionBar:!1},n.data("options"));const a=[i,o.webviewTitle,t];window.flutter_inappwebview.callHandler("openIntent",...a)}else isAndroidWebViewReady&&Android.openBrowser(i,t);else if("browser"==l)if(isFlutterInAppWebViewReady){let t=e.extend({actionBar:!1},n.data("options"));const a=[i,o.webviewTitle,t];window.flutter_inappwebview.callHandler("openBrowser",...a)}else isAndroidWebViewReady&&Android.openBrowser(i,t);else if("googlemap"==l)if(isFlutterInAppWebViewReady){const e=[i,o];window.flutter_inappwebview.callHandler("openGoogleMap",...e)}else isAndroidWebViewReady&&Android.openGoogleMap(i,t);else if("server"==l)if(isFlutterInAppWebViewReady){o.server;window.flutter_inappwebview.callHandler("changeServer",o.server)}else isAndroidWebViewReady&&Android.changeServer(o.server);else{if(!l)return!1;{let a=/^((http|https|ftp):\/\/)/;if(o.webviewTitle=o.webview,t=JSON.stringify(o),i=a.test(i)?i:document.location.origin+i,isFlutterInAppWebViewReady){let t=e.extend({actionBar:!0},n.data("options"));const a=[i,o.webviewTitle,t];window.flutter_inappwebview.callHandler("showWebView",...a)}else isAndroidWebViewReady&&Android.showWebView(i,t)}}},n.actionComplete=!1!==self.doAction(),n.version=function(){return n},n},e(document).on("click","[data-webview]",(function(t){return!e(this).openWebview(t,{}).actionComplete||(t.stopImmediatePropagation(),!1)}))}(jQuery),function($){let version="1.01",sgActionType="click",actionResult,debug;$.fn.sgAction=function(event,options={}){let $this=$(this),linkData=$this.data(),dataOptions=linkData.options,url=$this.attr("href"),relTarget=linkData.rel,retUrl=linkData.ret,para={},$boxElement=$("#cboxLoadedContent"),confirm=null==linkData.confirm||linkData.confirmed,callback=linkData.callback,relAction,doneResult;"javascript:void(0)"==url&&(url=linkData.url),relTarget&&(relAction=relTarget.split("->")[1],relTarget=relTarget.split("->")[0]);let defaults={result:"html",container:$(this),loadurl:linkData.loadurl,silent:!1,callback:!1},settings=$.extend({},$.fn.sgAction.defaults,defaults,dataOptions,options);return self.doAction=async function(){if(!confirm)return;if(linkData.confirmed&&($this.removeData("confirmed"),para.confirm="yes"),"box"==relTarget&&"clear"==relAction&&(sgBoxPageCount=0,$boxElement.empty()),linkData.before&&sgActionDone(linkData.before,$this),"close"==relTarget){if(0!=$this.closest(".sg-dropbox.box").length)return $(".sg-dropbox.box").children("div").hide(),void $(".sg-dropbox.box.active").removeClass("active");if($("#cboxLoadedContent").length)return void sgBoxBack({close:!0});if(isFlutterInAppWebViewReady)return void window.flutter_inappwebview.callHandler("closeWebView");if(isAndroidWebViewReady)return void Android.closeWebView();relTarget=void 0}else{if("back"==relTarget&&$boxElement.length)return void history.back();if("img"==relTarget)return void sgShowBox(null,$this,null,event)}if(null==relTarget&&null==retUrl){let e="{}"!=JSON.stringify(para),t=$this.attr("href");return t+=e?(-1==t.indexOf("?")?"?":"&")+$.param(para):"",window.location=t,!0}if(url&&"#"==url.substr(0,1)){let e=null;return"#"!=url&&$(url).length&&(e=$(url).get(0).innerHTML),sgUpdateData(e,relTarget,$this),void sgActionDone(linkData.done,$this,doneResult)}if(settings.silent||notify(settings.indicator),"iframe"==$this.data("type"))return sgShowBox('<iframe src="'+url+'"></iframe>',$this,{clearBoxContent:"clear"==relTarget}),void notify("");let urlMatch=url.match(/^(function|javascript)\:(.*)/);if(urlMatch){let urlFunction=urlMatch[2];if("javascript"===urlMatch[1])eval(urlFunction);else{let e=window[urlFunction];await e($this).then((function(){notify(),sgActionDone(linkData.done,$this,doneResult)}))}}else settings.fragment&&history.pushState({},document.title,"#"+url),$.post(url,para,(function(e){if(doneResult=e,notify(),settings.silent,retUrl?$.post(retUrl,(function(e){sgUpdateData(e,relTarget,$this),notify()})):sgUpdateData(e,relTarget,$this),linkData.removeparent){let e=linkData.removeparent;(e.charAt(0).match(/\.|\#/i)?$(e):$this.closest(e)).remove()}settings.callback&&settings.callback($this,e),callback&&"function"==typeof window[callback]?window[callback]($this,e):callback&&(window.location=callback)})).done((function(e){e.responseCode&&e.text&&notify(e.text,3e3),sgActionDone(linkData.done,$this,doneResult)})).fail((function(e){let t="ERROR : ";return null!=e.responseJSON&&e.responseJSON.text?t+=e.responseJSON.text+" ("+e.status+")":t+=e.statusText+" ("+e.status+")",notify(t),!1}))},self.test=function(){},$this.actionResult=!1!==self.doAction(),$this.version=function(){return $this},$this;return{ok:$this.actionResult,version:function(){return $this},update:function(e,t,a){},test:function(){return"Test"}}},$.fn.sgForm=function(){return this},$.fn.sgAction.defaults={indicator:"LOADING",tooltip:"คลิกเพื่อแก้ไข",cssclass:"inlineedit",width:"none",height:"none",cancelcssclass:"btn -link -cancel",submitcssclass:"btn -primary",showButtonPanel:!0,event:"edit",inputcssclass:""},$(document).on(sgActionType,".sg-action",(function(e){return!$(this).sgAction(e,{aTestOpt:"This is test option"}).actionResult}))}(jQuery),$(document).on("submit","form.sg-form",(function(e){let t,a=$(this),n=a.data("rel"),o=a.data("ret"),i=a.data("complete"),l=a.data("checkvalid"),s=a.data("onformsubmit"),r=a.data("silent"),d="",c="";if(l&&(a.find(".require, .-require").each((function(e){let t=$(this);if("text"!=t.attr("type")&&"password"!=t.attr("type")&&"hidden"!=t.attr("type")&&"TEXTAREA"!=t.prop("tagName")||""!=t.val().trim()?"SELECT"!=t.prop("tagName")||0!=t.val()&&-1!=t.val()&&""!=t.val()?"radio"!=t.attr("type")&&"checkbox"!=t.attr("type")||$("input[name='"+t.attr("name")+"']:checked").val()||(d=t,c=d.closest("div").children("label").first().text()):(d=t,c='กรุณาเลือกข้อมูลในช่อง " '+$("label[for="+d.attr("id")).text()+' "'):(d=t,c='กรุณาป้อนข้อมูลในช่อง " '+$("label[for="+d.attr("id")).text()+' "',t.focus()),d){let e=d.attr("id");return $("#"+e).isOnScreen()||$("html,body").animate({scrollTop:d.offset().top-100},"slow"),notify(c),!1}})),d))return!1;if(s&&"function"==typeof window[s])return new Promise(((t,a)=>window[s](e,this)));if(null==n)return!0;if(r||notify("PROCESSING"),a.hasClass("-upload"))a.ajaxSubmit({success:function(l){"remove"==i?a.remove():"close"!=i&&"closebox"!=i||(0!=$(e.rel).closest(".sg-dropbox.box").length?($(".sg-dropbox.box").children("div").hide(),$(".sg-dropbox.box.active").removeClass("active")):sgBoxBack()),o?$.post(o,(function(e){sgUpdateData(e,n,a),notify(),sgActionDone(a.data("done"),a,e)})):(sgUpdateData(l,n,a),sgActionDone(a.data("done"),a,t)),"notify"!=n&&notify(),a.replaceWith(a.clone(!0))},error:function(e){notify(e.statusText),sgUpdateData(e.responseText,n,a)}});else{let l=a.serialize();$.post(a.attr("action"),l,(function(l){if(t=l,"remove"==i?a.remove():"close"!=i&&"closebox"!=i||(0!=$(e.rel).closest(".sg-dropbox.box").length?($(".sg-dropbox.box").children("div").hide(),$(".sg-dropbox.box.active").removeClass("active")):sgBoxBack({close:!0})),o)$.post(o,(function(e){sgUpdateData(e,n,a),notify()}));else if(sgUpdateData(l,n,a),a.data("moveto")){let e=a.data("moveto").split(",");window.scrollTo(parseInt(e[0]),parseInt(e[1]))}"notify"!=n.substring(0,6)&&notify();let s=a.data("callback");s&&"function"==typeof window[s]?window[s](a,l):s&&(window.location=s)}),null==a.data("dataType")?null:a.data("dataType")).fail((function(e){let t="ERROR : ";return e.responseJSON.text?t+=e.responseJSON.text+" ("+e.status+")":t+=e.statusText+" ("+e.status+")",notify(t),!1})).done((function(e){e.responseCode&&e.text&&notify(e.text,3e3),sgActionDone(a.data("done"),a,t)}))}return!1})).on("keydown","form.sg-form input:text",(function(e){let t=$(this).closest("form").find("input:text"),a=t.length;if(13==e.keyCode){if(e.preventDefault(),"submit"==t.attr("onEnter"))return t.closest("form").submit(),!1;let n=t.index(this)+1;return n<a&&t[n].focus(),!1}})),function(e){let t,a=0,n=0,o={},i=!1,l="";function s(t,a,n){let o=a.showOn;if(self.processShow=(t,a)=>{if(a.hide){let t=a.hide;"nextInput"===t&&(t=n.next(".inlineedit-field")),e(t).addClass("-hidden").hide()}if(a.show){let t=a.show;"nextInput"===t&&(t=n.next(".inlineedit-field")),e(t).removeClass("-hidden").show()}},"hide"in o&&processShow(t,{hide:o.hide}),"show"in o&&processShow(show,{hide:o.show}),o.value)t==o.value?processShow(t,{show:o.element}):processShow(t,{hide:o.element});else if(o.values){document.querySelectorAll("input[name="+n.data("inputName")+"]:checked").forEach((e=>{o.values[e.value]&&processShow(e.value,o.values[e.value])}))}}function r(e,t){t.find("input[type=checkbox]:checked").length>=e.maxCheckbox?t.find('input[type=checkbox]:not(":checked")').attr("disabled","disabled"):t.find("input[type=checkbox]").attr("disabled",null)}e.fn.sgInlineEdit2=function(t,d={}){if(void 0===e.fn.editable)return;if("disable"===t)return;if("enable"===t)return;if("destroy"===t)return;i=!0;let c=e(this),u=c.closest(".inlineedit-field"),p=c.closest(".sg-inlineedit");l=u.data("type");let f=p.attr("onSave"),g=u.data("callback"),h=u.data("options")?u.data("options"):{},m=h&&"button"in h||"yes"==u.data("button"),b=u.data("action")?u.data("action"):u.data("updateUrl"),w=!1;if(void 0===b&&(b=p.data("action")?p.data("action"):p.data("updateUrl")),"money"==l||"numeric"==l||"text-block"==l)l="text";else if("radio"==l||"checkbox"==l);else{if("link"==l)return;""!=l&&null!=l||(l="text",u.data("type","text"))}let v={type:l,result:"json",container:u,onblur:u.data("onblur")?u.data("onblur"):"submit",onedit:function(e,t,a){},onerror:function(e,t,a){},onreset:function(e,t){},onsubmit:function(e,t){let a=u.data("options"),n=null!=a&&a.hasOwnProperty("onSubmit")?a.onSubmit:null;return n&&"function"==typeof window[n]&&window[n](e,t),!0},data:function(e,t){return u.data("data")?u.data("data"):null!=u.data("value")?u.data("value"):"..."==e?"":e},loadurl:u.data("loadurl"),before:function(){let e=u.data("options"),t=null!=e&&e.hasOwnProperty("onBefore")?e.onBefore:null;t&&"function"==typeof window[t]&&window[t](u,p)},cancel:m?'<button class="widget-button btn -link -cancel"><i class="icon -material -gray">cancel</i><span>ยกเลิก</span></button>':null,submit:m?'<button class="widget-button btn -primary"><i class="icon -material -white">done_all</i><span>บันทึก</span></button>':null,placeholder:u.data("placeholder")?u.data("placeholder"):"...",inputcssclass:()=>{let e="";return e="numeric"==l?"form-text -numeric":"money"==l?"form-text -money":"email"==l?"form-text -email":"url"==l?"form-text -url":"autocomplete"==l?"form-text -autocomplete":"form-"+l,e}};return o=e.extend({},e.fn.sgInlineEdit2.defaults,v,d,p.data("options"),u.data("options"),c.data("options")),w=!!p.data("debug"),h&&"debug"in h&&h.debug&&(w=!0),w=o.debug,self.validValue=(e,t)=>{let a="";if(null!=t.minValue&&1*(e=e.replace(/[^0-9.\-]+|\.(?!\d)/g,""))<t.minValue&&(a="ข้อมูลมีค่าน้อยกว่าช่วงที่กำหนด"),null!=t.maxValue&&1*(e=e.replace(/[^0-9.\-]+|\.(?!\d)/g,""))>t.maxValue&&(a="ข้อมูลมีค่ามากกว่าช่วงที่กำหนด"),t.pattern){t.container.find(".form-text")[0].checkValidity()||(a="ข้อมูลไม่ถูกต้องตามรูปแบบที่กำหนด")}return a?(t.container.addClass("-invalid"),a):(t.container.removeClass("-invalid"),!0)},self.saveToServer=(t,s,r)=>{if(void 0===b)return void notify("ข้อมูลปลายทางสำหรับบันทึกข้อมูลผิดพลาด (ไม่ได้ระบุ)");let d=e.extend({},p.data(),t.data()),c=d.retType||d.ret;delete d.updateUrl,delete d.options,delete d.choices,delete d.data,delete d["event.editable"],delete d.uiAutocomplete,delete d.rel,delete d.done,d.action="save",d.value="string"==typeof s?s.replace(/\"/g,'"'):s,t.data("inputName")&&(d[t.data("inputName")]=s),o.var&&(d[o.var]=d.value),t.data("value",d.value),a++,n++,notify("กำลังบันทึก กรุณารอสักครู่...."+(w?"<br />Updating : pending = "+a+" To = "+b+"<br />":"")),e.post(b,d,(function(i){if(a--,p.find(".inlineedit-field").removeClass("-disabled"),"string"==typeof i){let e=i;(i={}).value=d.value,w&&(i.msg=e)}if("refresh"==c)window.location=window.location;else if("autocomplete"==l)t.data("value",d.value),t.find(".-for-input").html(i.value);else if("radio"==l);else if("checkbox"==l);else if("select"==l){let e;e=t.data("data")?t.data("data")[i.value]:i.value,t.find(".-for-input").html(e)}else t.find(".-for-input").html(null==i.value?'<span class="placeholder -no-print">'+o.placeholder+"</span>":i.value);let s="";d.tr!=i.tr&&(0==i.tr&&(i.tr=""),e('[data-group="'+d.group+'"]').data("tr",i.tr),s="Replace tr of group "+d.group+" with "+i.tr),notify(("error"in i?i.error:"msg"in i?i.msg:"บันทึกเรียบร้อย")+(w?'<div class="-sg-text-left" style="white-space: normal;">Update queue = '+n+", Update pending = "+a+"<br /><b>POST PARAMETER:</b><pre>"+JSON.stringify(d,null,"\t")+"</pre><b>RETURN VALUE:</b><pre>"+JSON.stringify(i,null,2).replace(/\\n/g,"<br>").replace(/\\t/g,"  ").replace(/\\/g,"")+"</pre><br />"+s+"</div>":""),w?3e5:5e3)}),o.result).fail((function(e){notify("ERROR ON POSTING. Please Contact Admin.")})).done((function(a){f&&"function"==typeof window[f]&&window[f](o,t,a);let n=r;n&&("function"==typeof window[n]?window[n](t,a,p):"silent"==o.callbackType?e.get(n,(function(){})):window.location=n),o.done&&sgActionDone(o.done,t,a),i=!1}))},self.saveRadio=()=>{let e=c.attr("value");self.saveToServer(u,e,g),"showOn"in h&&s(e,h,u)},self.saveCheckbox=()=>{if(r(o,u),"array"===u.data("jsonType")){let t=c.closest(".inlineedit-field").find("input:checked"),a=[];t.each((function(t,n){a.push(e(this).attr("value"))})),self.saveToServer(u,a,g)}else{let e=c.is(":checked")?c.attr("value"):"";self.saveToServer(u,e,g)}"showOn"in h&&s(null,h,u)},self.saveEditable=()=>{c.editable((function(e,t){let a=validValue(e,t);return 1!=a?(notify(a,2e3),setTimeout((function(){t.container.find("-for-input").trigger("click")}),100),e):(t.saveData&&self.saveToServer(u,e,g),e)}),o).trigger("edit")},self.saveValue=(e,t,a)=>{},"radio"==l?saveRadio():"checkbox"==l?saveCheckbox():saveEditable(),{settings:o,getVersion:function(){return"2.01"},validValue:function(e,t){return self.validValue(e,t)},onKeyDown:function(t,a,n,o){let i=o||window.event;if(9==i.keyCode){let o=e(n),l=o.find(".form-text");if(l.length){let e=a.validValue(l.val(),t);if(1!=e)return notify(e,2e3),i.returnValue=!1,void(i.preventDefault&&i.preventDefault())}let s,r,d=o.closest(".sg-inlineedit").find(".inlineedit-field:not(.-hidden"),c=d.index(n);return s=c===d.length-1?d.eq(0):d.eq(c+1),r=s.find(".-for-input"),o.find("input").blur(),setTimeout((function(){switch(s.data("type")){case"text":case"textarea":r.trigger("click");break;case"radio":case"checkbox":r=s.find(".-for-input:first-child"),r.focus();break}}),100),!1}},update:function(e,t,a){self.saveToServer(e,t,a)},saveValue:function(e,t,a){}}},e.fn.sgInlineEdit2.defaults={indicator:'<div class="loader -rotate"></div>',tooltip:"คลิกเพื่อแก้ไข",cssclass:"inlineedit",width:"none",height:"none",var:null,cancelcssclass:"btn -link -cancel",submitcssclass:"btn -primary",showButtonPanel:!0,indicator:"SAVING",event:"edit",inputcssclass:"",autocomplete:{},datepicker:{},saveData:!0},e(document).on("click",".sg-inlineedit .inlineedit-field:not(.-readonly) .-for-input",(function(){t=e(this).sgInlineEdit2()})),e(document).on("keydown",".sg-inlineedit .inlineedit-field",(function(e){t.onKeyDown(t.settings,t,this,e)})),e(document).ready((function(){void 0!==e.fn.editable&&(e(".inlineedit-field[data-options]").each((function(t){let a=e(this),n=a.data("options");if("maxCheckbox"in n&&r(n,a),"showOn"in n){let e=a.data("inputName");s(a.find("input[name="+e+"]:checked").val(),n,a)}})),e.editable.addInputType("checkbox",{}),e.editable.addInputType("radio",{}),e.editable.addInputType("autocomplete",{element:e.editable.types.text.element,plugin:function(t,a){e(a).attr("autocomplete","off");let n={target:"",source:function(a,n){let o=t.autocomplete.query,i={};i.q=a.term,e.get(o,i,(function(t){n(e.map(t,(function(e){return e})))}),"json")},minLength:2,dataType:"json",cache:!1,focus:function(e,t){e.preventDefault()},select:function(n,o){this.value=o.item.label;let i=t.autocomplete.target;if(i){"string"==typeof i&&(i=JSON.parse('{"'+i+'": "value"}'));for(let t in i){let n=o.item[i[t]];"#"==t.substring(0,1)||"."==t.substring(0,1)?e(t).val(o.item.value):e(a).data(t,n)}}e(this).submit()}};t.autocomplete=e.extend({},n,t.autocomplete),e("input",this).autocomplete(t.autocomplete).autocomplete("instance")._renderItem=function(t,a){return"..."==a.value?e('<li class="ui-state-disabled -more"></li>').append(a.label).appendTo(t):e("<li></li>").append("<a><span>"+a.label+"</span>"+(null!=a.desc?"<p>"+a.desc+"</p>":"")+"</a>").appendTo(t)}}}),e.editable.addInputType("datepicker",{element:function(t,a){let n=e('<input class="form-text -datepicker" />');n.attr("autocomplete","off");let o={format:"dd/mm/yy",monthNames:thaiMonthName,beforeShow:function(t){e(".ui-datepicker:visible").css({top:"+=5"})},open:function(){e(".ui-datepicker:visible").css({top:"+=5"})},onSelect:function(){e(this).submit()}};return t.datepicker=e.extend({},o),n.datepicker(t.datepicker),t.datepicker.format&&n.datepicker("option","dateFormat",t.datepicker.format),e(this).append(n),n},submit:function(t,a){let n,o=e("input",this).datepicker("getDate");n=null===o?null:t.datepicker.format?e.datepicker.formatDate(t.datepicker.format,new Date(o)):o,n?e("input",this).val(n):e("input",this).val(""),e("input",this).datepicker("hide")},plugin:function(e,t){e.onblur="nothing"}}))}))}(jQuery),function(e){e(document).on("click",".sg-expand",(function(){let t=e(this),a=e(this).find(".icon");if(t.data("rel"))e(t.data("rel")).toggle();else{e(this).closest(".widget-listtile").next().toggle()}"expand_less"==a.text()?a.text("expand_more"):"expand_more"==a.text()?a.text("chevron_right"):"chevron_right"==a.text()&&a.text("expand_more")}))}(jQuery),function(e){let t=0;e.fn.sgDrawReport=function(t,a={}){let n=e(this),o=n.closest("form"),i=n.closest(".sg-drawreport"),l=i.data("query"),s=!1,r=e("#report-output-debug"),d=i.data("callback"),c=i.data("options"),u={dataType:"json",container:e(this),callback:!1},p=e.extend({},e.fn.sgDrawReport.defaults,u,c,a);return s=p.debug,self.startDrawReport=function(t){if("html"==p.dataType){return void e(i.data("showHtml")).html(t)}let a=i.find("#report-output-debug").empty();t.debug&&t.process&&t.process.forEach((function(t){a.show(),a.append(e("<div></div>").html(t))})),i.data("showChart")&&showChart(t),i.data("showSummary")&&showSummary(t),i.data("showItems")&&showItems(t),i.data("showHtml")&&showHtml(t)},self.showChart=function(t){let a=e(i.data("showChart")),n=i.find("#graphtype").val(),o=[["รายการ","จำนวน"]];if(null==t.summary||0==a.length)return;t.summary.forEach((function(e,t){o.push([e.label,e.project])}));let l,s=google.visualization.arrayToDataTable(o),r={title:t.title,hAxis:{title:"H Axis",titleTextStyle:{color:"black"}},vAxis:{title:"Y Axis",minValue:0},isStacked:!1};l="Bar"==n?new google.visualization.BarChart(document.getElementById("report-output-chart")):"Col"==n?new google.visualization.ColumnChart(document.getElementById("report-output-chart")):"Line"==n?new google.visualization.LineChart(document.getElementById("report-output-chart")):new google.visualization.PieChart(document.getElementById("report-output-chart")),l.draw(s,r)},self.showSummary=function(t){let a=e(i.data("showSummary"));if(a.empty(),null==t.summary||0==a.length)return;let n=e("<table></table>").addClass("widget-table"),o=e("<thead></thead>");if(Object.keys(t.summaryFields).forEach((function(a){o.append(e("<th></th>").text(t.summaryFields[a]))})),n.append(o),t.summary.forEach((function(a,o){let i=e("<tr></tr>").addClass("row");Object.keys(t.summaryFields).forEach((function(t){let n=a[t];"number"==typeof n&&parseInt(n)!=n&&(n=thousandsSeparators(n)),i.append(e("<td></td>").addClass("col "+("label"==t?"":"-center")).text(n))})),n.append(i)})),t.total){let a=e("<tfoot></tfoot").append(e("<tr></tr>"));Object.keys(t.summaryFields).forEach((function(n){"label"==n?a.append("<td>รวมทั้งสิ้น</td>"):"%"==t.summaryFields[n]?a.append(e("<td></td>").addClass("col -center").text("100%")):a.append(e("<td></td>").addClass("col -center").text(t.total[n]))})),n.append(a)}a.append(n)},self.showItems=function(t){let a=e(i.data("showItems")),n=!1;if(a.empty(),null==t.items||0==a.length)return;if(n=t.items.length>0,!n)return;let o=e("<a/>");o.addClass("btn").html('<i class="icon -material">cloud_download</i><span>EXPORT</span>').attr("href","javascript:void(0)").attr("onClick",'export2excel("trans")'),a.append(e("<nav></nav>").addClass("nav -page -table-export -sg-text-right").append(o));let l=e("<table></table>").addClass("widget-table").attr("id","detail-list"),s=e("<thead></thead>").append(e("<tr></tr>"));Object.keys(t.itemsFields).forEach((function(a){s.append(e("<th></th>").text(t.itemsFields[a]))})),l.append(s);let r=e("<tbody></tbody>");t.items.forEach((function(a,n){let o,i=e("<tr></tr>").addClass("row"),l=e("<a/>");"object"==typeof a.config.link&&(o=a.config.link.field,l.attr("href",a.config.link.href).text(a[a.config.link.field]).addClass("sg-action").attr("target","_blank").data("rel","box").data("width",640).data("webview",a.fullname)),Object.keys(t.itemsFields).forEach((function(t){i.append(e("<td></td>").html(t==o?l:a[t]))})),r.append(i)})),l.append(r),a.append(l)},self.showHtml=function(t){let a=e(i.data("showHtml"));a.empty(),null!=t.html&&a.html(t.html)},self.apiParameter=function(){let e={};return o.serializeArray().map((function(t){t.name.match(/\[\]$/)?(null==e[t.name]&&(e[t.name]=[]),e[t.name].push(t.value)):e[t.name]=t.value})),e},self.makeFilterBtn=function(){let t=i.find("#toolbar-report-filter-items");t.empty(),e(".sg-drawreport .-filter-checkbox:checked").each((function(a){t.append('<span class="" data-src="'+e(this).attr("id")+'">'+e(this).closest("label").text()+'<a class="-filter-remove"><i class="icon -material -sg-16">close</i></a></span>')}))},self.startDebug=function(t){r.empty().show(),r.append(e("<a>").text("Get data api url").attr({href:l+"&"+new URLSearchParams(t),target:"_blank"})).append("<br>").append(JSON.stringify(t)).append("<hr>")},self.doAction=function(){let a=e(".report-output").css("opacity");n.hasClass("-submit-group")?(n.closest("ul").children().removeClass("-active"),n.closest("li").addClass("-active"),e("#reporttype").val(n.attr("href").slice(1))):n.hasClass("-graph")&&e("#graphtype").val(n.val()),e(".report-output").css("opacity",.5);let o=apiParameter();if(s&&startDebug(o),e.post(l,o,(function(e){notify()}),p.dataType).fail((function(t){notify("ERROR ON POSTING"),e(".report-output").css("opacity",a)})).done((function(t){e(".report-output").css("opacity",a),debugSG&&t.debug,d&&"function"==typeof window[d]?window[d](n,t):startDrawReport(t)})),null!=t){"checkbox"!=e(t.target).attr("type")&&t.preventDefault()}},n.doAction=function(){return doAction(),n},n.showChart=function(e){return showChart(e),n},n.showSummary=function(e){return showSummary(e),n},n.showItems=function(e){return showItems(e),n},n.showHtml=function(e){return showHtml(e),n},n.version=function(){return n},n.makeFilterBtn=function(){return makeFilterBtn(),n},n.apiParameter=function(){return apiParameter()},n.queryUrl=l,n},e.fn.sgDrawReport.defaults={indicator:"LOADING",debug:!1},e(document).on("click","#toolbar-report-filter-items a.-filter-remove",(function(){let t=e(this).closest("span").data("src");e("#"+t).prop("checked",!1);let a=e("#"+t).closest("li").find(".-amt");a.html(a.text()-1);e(this).sgDrawReport(event,{aTestOption:"This is test option"}).doAction();e(this).parent().remove()})),e(document).on("click",".sg-drawreport .-submit",(function(t){return e(this).sgDrawReport(t,{aTestOption:"This is test option"}).doAction()})),e(document).on("change",".sg-drawreport .-filter-checkbox",(function(){let t=0;e(this).closest(".-checkbox").find(".-filter-checkbox:checked").each((function(e){t++})),e(this).closest("li").find(".-check-count>.-amt").html(t).parent().removeClass("-hidden").addClass(t>0?"":"-hidden"),e(this).sgDrawReport().makeFilterBtn()})),e(document).on("click",".sg-drawreport .group-nav",(function(){let a=e(this),n=a.hasClass("-left"),o=a.closest(".-group"),i=o.width()-60,l=o.find("ul>li").width(),s=Math.floor(i/l),r=Math.ceil(o.find("ul").width()/i);n?t>0&&t--:t<r-1&&t++;let d=t*l*s+(s*t+1)-1;o.find("ul").animate({left:-d+"px"},"fast")}))}(jQuery),$(document).on("click",".widget-tabbar>.tabs>li>a, .sg-tabs>.ui-tab>.ui-item>a, .sg-tabs>ul.tabs>li>a, .sg-tabs>ul>li>a",(function(e){let t=$(this),a=t.closest(".sg-tabs"),n=t.attr("href");if(t.closest("ul").children("li").removeClass("-active"),t.closest("li").addClass("-active"),null!=t.attr("target"))return!0;null==n||"javascript:void(0)"==n||("#"==n.left(1)?(a.children("div").hide(),a.children(t.attr("href")).show()):t.hasClass("sg-action")||(notify("LOADING"),$.post(n,(function(e){a.children("div").html(e),notify()}))));let o=t.data("callback");return o&&"function"==typeof window[o]?window[o](t,html):o&&(window.location=o),!1})),$(document).on("click",".sg-dropbox>a",(function(){let e=$(this).parent(),t=$(this).next(),a=e.find(".sg-dropbox--content");$(".sg-dropbox.click").not($(this).parent()).each((function(){$(this).children("div").hide()})),"box"==e.data("type")?(e.css("display","block").addClass("active"),null!=e.data("url")?(a.html("LOADING"),t.show(),$.get(e.data("url"),(function(e){a.html(e)}))):t.show()):"click"==e.data("type")?t.show():t.toggle();let n=$(this).offset(),o=t.width(),i=$(document).width();if(n.left+o>i){let e=i-n.left-$(this).width()-8;t.css({rightside:e+"px"})}return!1})).on("click","body",(function(e){0==$(e.target).closest(".sg-dropbox").length&&$(".sg-dropbox.click").children("div").hide(),0===$(e.target).closest(".sg-dropbox.box").length&&($(".sg-dropbox.box").children("div").hide(),$(".sg-dropbox.box.active").removeClass("active"))})),$(document).on("focus",".sg-datepicker",(function(e){$(this).attr("autocomplete","off");let t={clickInput:!0,dateFormat:"dd/mm/yy",altFormat:"yy-mm-dd",altField:"AAAA",disabled:!1,monthNames:thaiMonthName,beforeShow:function(e){$(this).data("previous",$(e).val()),$(".ui-datepicker:visible").css({top:"+=5"})},open:function(){},onSelect:function(e,t){if($(this).data("previous")!=e){if($(this).data("diff")){let t=$("#"+$(this).data("diff")),a=$(this);if(""==t.val())t.val(a.val());else{let a=0,n=864e5,o=($(this).data("previous")?$(this).data("previous"):e).split("/"),i=$(this).val().split("/"),l=t.val().split("/"),s=new Date(o[2],o[1]-1,o[0]),r=new Date(l[2],l[1]-1,l[0]),d=new Date(i[2],i[1]-1,i[0]);a=Math.round((r-s)/n);let c=new Date(d);c.setDate(d.getDate()+a);let u=c.getDate(),p=c.getMonth()+1,f=c.getFullYear(),g="00",h=(g+u).slice(-g.length)+"/"+(g+p).slice(-g.length)+"/"+f;t.val(h)}}$(this).trigger("dateupdated")}let a=$(this).data("callback");if(a)if("submit"==a)$(this).closest("form").submit();else if("function"==typeof window[a])window[a](e,$(this));else{let e=a+"/";window.location=e}}},a=$.extend(t,$(this).data());$(this).datepicker(a)})),$(document).on("focus",".sg-address",(function(e){let t=$(this);t.autocomplete({source:function(e,t){$.get(SG.url("api/address?q="+encodeURIComponent(e.term)),(function(e){t(e)}),"json")},minLength:6,dataType:"json",cache:!1,select:function(e,a){this.value=a.item.label,t.data("altfld")&&$("#"+t.data("altfld")).val(a.item.value);let n=t.data("callback");if(n)if("submit"==n)$(this).closest("form").trigger("submit");else if("function"==typeof window[n])window[n](t,a);else{let e=n+"/"+a.item.value;window.location=e}return!1}}).autocomplete("instance")._renderItem=function(e,t){return"..."==t.value?$('<li class="ui-state-disabled -more"></li>').append(t.label).appendTo(e):$("<li></li>").append("<a><span>"+t.label+"</span>"+(null!=t.desc?"<p>"+t.desc+"</p>":"")+"</a>").appendTo(e)}})),$(document).on("focus",".sg-autocomplete",(function(e){let t=$(this),a=t.closest("form"),n=1;t.data("minlength")&&(n=t.data("minlength")),t.autocomplete({minLength:n,dataType:"json",cache:!1,source:function(e,a){let n={};n.n=t.data("item"),n.q=t.val(),notify("กำลังค้นหา"),$.get(t.data("query"),n,(function(e){notify(),a(e);let n=t.data("renderComplete");if(n&&"function"==typeof window[n])return window[n](t)}),"json")},open:function(){$(".ui-autocomplete:visible").css({top:"+=5"}),t.data("class")&&t.autocomplete("widget").addClass(t.data("class")),t.data("width")&&t.autocomplete("widget").css({width:t.data("width")})},focus:function(e,t){return!1},select:function(e,n){if(t.data("altfld")){let e="#"+t.data("altfld");a.find(e).length?a.find(e).val(n.item.value):$(e).val(n.item.value)}if(null!=t.data("select")){let e=t.data("select");if("object"==typeof e){let t;for(t in e)$("#"+t).val(n.item[e[t]])}else"string"==typeof e&&t.val(n.item[e])}else t.val(n.item.label);let o=t.data("callback");if(o)if("submit"==o)$(this).closest("form").trigger("submit");else if("function"==typeof window[o])window[o](t,n);else{let e=o.match(/\?/i)?"":"/",t=o+e+n.item.value;window.location=t}return!1},response:function(e,a){let n=t.data("renderStart");n&&"function"==typeof window[n]&&window[n](t,a)}}).autocomplete("instance")._renderItem=function(e,a){let n=t.data("renderItem");return n&&"function"==typeof window[n]?window[n](t,e,a):"..."==a.value?$('<li class="ui-state-disabled -more"></li>').append(a.label).appendTo(e):$("<li></li>").append("<a><span>"+(null!=a.altLabel?a.altLabel:a.label)+"</span>"+(null!=a.desc?"<p>"+a.desc+"</p>":"")+"</a>").appendTo(e)}})),$(document).on("change","form.sg-upload .inline-upload",(function(){let e=$(this),t=e.closest("form"),a=t.data("rel"),n=' class="'+(null!=t.data("class")?t.data("class"):"ui-item -item -hover-parent")+'"';if(isAndroidWebViewReady&&Android.showToast("กำลังอัพโหลดไฟล์"),t.data("before")){let a=t.data("before"),o="<"+a+n+'><div class="loader -rotate -center"></div></'+a+">";e.closest(a).before(o)}else notify('<div class="loader -rotate"></div> กำลังอัพโหลดไฟล์ กรุณารอสักครู่');t.ajaxForm({success:function(o){if(isAndroidWebViewReady&&Android.showToast("อัพโหลดไฟล์เรียบร้อบ"),a)if(t.data("append")){let e="<"+t.data("append")+n+">"+o+"</"+t.data("append")+">";$(a).append(e)}else if(t.data("prepend")){let e="<"+t.data("prepend")+n+">"+o+"</"+t.data("prepend")+">";$(a).prepend(e)}else if(t.data("before"))$targetElement.prev().html(o);else if(t.data("after")){let a="<"+t.data("after")+n+">"+o+"</"+t.data("after")+">";e.closest(t.data("after")).after(a)}else sgUpdateData(o,a,e);notify("ดำเนินการเสร็จแล้ว.",5e3),e.val(""),e.replaceWith(e.clone(!0)),sgActionDone(t.data("done"),t,o)},error:function(e,t,a){notify(a,5e3)}}).submit()})),$(document).ready((function(){$(".sg-chart").each((function(e){drawChart(this)}))}));let sgDrawMap=function(e,t={}){let a,n,o=$.extend({},{gisDigit:14,zoom:9,center:[],drag:"pin",dropPin:!1,dropPinText:null,updateUrl:null,updatePara:null,updateIcon:null,mapCanvas:"#map-canvas",height:"100%",mapHeight:"100%",showGetCurrent:!0,pin:[],markers:[],address:[],done:null,debug:!1,callback:!1},t);o.debug;let i=$("#current-location .value"),l=o.updateUrl,s=!!o.pin.lat,r="",d=l?("map"==o.drag?"เลื่อนแผนที่":"ลากหมุด")+"เพื่อเปลี่ยนตำแหน่ง":"";$(".box-page").css({width:"100%",height:"100%",minWidth:"100%",minHeight:"100%"}),$(".page.-map").css({height:o.height,minWidth:"100%",minHeight:o.height}),$(o.mapCanvas).css({width:"100%",height:o.mapHeight,minWidth:"100%",minHeight:"100%"}),o.dropPin?s?notify(d,2e4):!s&&o.updateUrl&&notify("คลิกบนแผนที่ตรงตำแหน่งที่ต้องการวางหมุด",2e4):s=!0;let c=new GMaps({div:o.mapCanvas,zoom:o.zoom,scrollwheel:!0,lat:o.center.lat,lng:o.center.lng,click:function(e){if(!o.updateUrl)return;if(s)return;notify(d,2e4),n=e.latLng.lat().toFixed(o.gisDigit)+","+e.latLng.lng().toFixed(o.gisDigit),a=f({lat:e.latLng.lat(),lng:e.latLng.lng()}),s=!0,new google.maps.InfoWindow({content:r}).open(c,a),i.text(n)}});if("map"==o.drag&&c.addListener("center_changed",(()=>{a&&(a.setPosition(c.getCenter()),p(c.getCenter().lat(),c.getCenter().lng()))})),o.pin.lat&&o.pin.lng){a=f(o.pin),new google.maps.InfoWindow({content:r}).open(c,a)}function u(e){if(null==l)return!1;let t=null==o.updatePara?{}:o.updatePara;t.location=e,o.debug,$.post(l,t,(function(t){let a="https://www.google.com/maps/place/"+e,n="geo:?q="+e;$("#googlemap").attr("href",a).removeClass("-hidden"),$("#googlenav").attr("href",n).removeClass("-hidden");let i=""!=e?"-active":"";o.updateIcon&&$(o.updateIcon).removeClass("-active").addClass(i)})).done((function(t){notify(t.text,3e3),o.done&&sgActionDone(o.done,null,e)})).fail((function(e){notify(e.responseJSON.text,3e3)}))}function p(e,t){let a=$("#current-location");a.find(".value").text(e.toFixed(o.gisDigit)+","+t.toFixed(o.gisDigit)),a.find(".show").text(e.toFixed(4)+","+t.toFixed(4))}function f(t){let a="",i='<nav class="nav -sg-flex"><a class="sg-action btn -link -cancel" href="#current-location" data-rel="none" data-title="ลบหมุด" data-confirm="ลบหมุด กรุณายืนยัน?" data-done="javascript:'+e+'.clearMap()"><i class="icon -material">cancel</i><span>ลบหมุด</span></a><a class="btn -primary" onClick=\''+e+'.locationUpdate($("#current-location>.value").text());return false;\'><i class="icon -material">done</i><span>บันทึกตำแหน่ง</span></a></nav>';return n=t.lat.toFixed(o.gisDigit)+","+t.lng.toFixed(o.gisDigit),t.info?a=t.info:t.currentLocation&&null!=o.locationText?a=o.locationText:o.pin&&null!=o.pin.content&&(a=o.pin.content),r='<div class="map-info">'+a+(o.updateUrl?i:"")+'<div id="current-location" class="current-location">พิกัด <span class="value -hidden">'+n+'</span><span class="show">'+t.lat.toFixed(4)+","+t.lng.toFixed(4)+'</span>\x3c!-- TODO:: <a class="btn -link" style="padding: 2px 4px 2px 8px; margin-left: 8px;" onClick=\''+e+'.editLocation($("#current-location>.value").text());return false;\'><i class="icon -material -sg-16">edit</i><span>แก้ไข</span></a> --\x3e</div></div>',c.addMarker({lat:t.lat,lng:t.lng,draggable:!!o.updateUrl&&"map"!=o.drag,infoWindow:{title:o.pin.title,content:r},dragend:function(e){p(e.latLng.lat(),e.latLng.lng())}})}return o.markers&&$.each(o.markers,(function(e,t){t.lat&&t.lng&&c.addMarker({lat:t.lat,lng:t.lng,draggable:null!=t.draggable&&t.draggable,icon:null==t.icon?"https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=|CCCCCC|FFFFFF":t.icon,infoWindow:{content:null==t.content?"":t.content}})})),o.address&&$.each(o.address,(function(e,t){GMaps.geocode({address:t,callback:function(a,n){if("OK"==n){let n=a[0].geometry.location;s||0!=e||c.setCenter(n.lat(),n.lng()),c.addMarker({lat:n.lat(),lng:n.lng(),icon:"https://softganz.com/library/img/geo/circle-green.png",infoWindow:{content:t}})}}})})),o.showGetCurrent&&$("#getgis").click((function(){return notify("กำลังหาตำแหน่งปัจจุบัน"),navigator.geolocation?navigator.geolocation.getCurrentPosition((function(e){if(notify(),c.setCenter({lat:e.coords.latitude,lng:e.coords.longitude}),null==a){a=f({lat:e.coords.latitude,lng:e.coords.longitude,currentLocation:!0}),new google.maps.InfoWindow({content:r}).open(c,a),s=!0}a.setPosition(c.getCenter()),p(e.coords.latitude,e.coords.longitude)}),(function(e){notify("Error: The Geolocation service failed. ("+e.message+")",5e3)}),{timeout:7e3,enableHighAccuracy:!0,maximumAge:0}):notify("Error: Browser doesnt support Geolocation.",5e3),!1})),{map:c,clearMap:function(){s=!1,u(""),a.setMap(null)},createMarker:f,locationUpdate:u,editLocation:function(e){if(null==l)return!1},currentMarker:function(){return n},settings:o}};$(document).on("change",".sg-area-fund",(function(){let e=$(this),t=e.closest("form"),a=(t.find(".sg-area-fund"),t.find(".sg-changwat")),n=t.find(".sg-ampur"),o=t.find(".sg-tambon"),i=t.find(".sg-village"),l=e.data("altfld");""==e.val()?a.val("").hide():a.val(""),n.length&&n.val("").hide(),o.length&&o.val("").hide(),i.length&&i.val("").hide(),a.length&&(a[0].options.length=1),n.length&&(n[0].options.length=1),o.length&&(o[0].options.length=1),i.length&&(i[0].options.length=1),l&&t.find(l).val(e.val()),$.get(SG.url("api/changwat"),{areaFund:e.val()},(function(e){e.length?a.show():a.hide();for(let t=0;t<e.length;t++)a.append($("<option></option>").text(e[t].label).val(e[t].changwat))}),"json"),"submit"==e.data("change")&&t.submit()})),$(document).on("change",".sg-changwat",(function(){let e=$(this),t=e.closest("form"),a=(t.find(".sg-changwat"),t.find(".sg-ampur")),n=t.find(".sg-tambon"),o=t.find(".sg-village"),i=e.data("altfld");""==e.val()?a.val("").hide():a.val(""),n.val("").hide(),o.length&&o.val("").hide(),a.length&&(a[0].options.length=1),n.length&&(n[0].options.length=1),o.length&&(o[0].options.length=1),i&&t.find(i).val(e.val()),$.get(SG.url("api/ampur"),{q:e.val()},(function(e){e.length?a.show():a.hide();for(let t=0;t<e.length;t++)a.append($("<option></option>").text(e[t].label).val(e[t].ampur))}),"json"),"submit"==e.data("change")&&t.submit()})),$(document).on("change",".sg-ampur",(function(){let e=$(this),t=e.closest("form"),a=t.find(".sg-changwat"),n=t.find(".sg-ampur"),o=t.find(".sg-tambon"),i=t.find(".sg-village"),l=e.data("altfld");""==e.val()?o.val("").hide():o.val(""),i.val("").hide(),o.length&&(o[0].options.length=1),i.length&&(i[0].options.length=1),l&&t.find(l).val(a.val()+e.val()),$.get(SG.url("api/tambon"),{q:a.val()+n.val()},(function(e){e.length?o.show():o.hide();for(let t=0;t<e.length;t++)o.append($("<option></option>").text(e[t].label).val(e[t].tambon))}),"json"),"submit"==e.data("change")&&t.submit()})),$(document).on("change",".sg-tambon",(function(){let e=$(this),t=e.closest("form"),a=t.find(".sg-changwat"),n=t.find(".sg-ampur"),o=t.find(".sg-tambon"),i=t.find(".sg-village"),l=e.data("altfld");l&&t.find(l).val(a.val()+n.val()+e.val()),i.length&&(""==e.val()?i.val("").hide():i.val("").show(),i.length&&(i[0].options.length=1),$.get(SG.url("api/village"),{q:a.val()+n.val()+o.val()},(function(e){for(let t=0;t<e.length;t++)i.append($("<option></option>").text(e[t].label).val(e[t].village))}),"json"),"submit"==e.data("change")&&t.submit())})),$(document).on("change",".sg-village",(function(){let e=$(this),t=e.closest("form"),a=t.find(".sg-changwat"),n=t.find(".sg-ampur"),o=t.find(".sg-tambon");t.find(".sg-village");a.data("altfld")&&$(a.data("altfld")).val(a.val()+n.val()+o.val()+e.val()),"submit"==e.data("change")&&t.submit()})),$(document).on("click",'.widget-table>thead>tr>th[class*="-sort-"]',(function(e){if(notify("Sorting!!! Please wait...",100),$(this).closest("thead").find("th").removeClass("-order"),$(this).addClass("-order"),!$(this).closest("table").attr("id"))return;$(this).prevAll().length}));