"use strict";let sgUiVersion="4.00.01",debugSG=!1,defaultRelTarget="#main";console.log("SG-UI Version "+sgUiVersion+" loaded");let isAndroidWebViewReady="object"==typeof Android,isFlutterInAppWebViewReady=!1;function sgFindTargetElement(e,t){return"this"==e?t:"parent"==e?t.parent():e.match(/^parent /i)?t.closest(e.substring(7)):"before"==e?t.before():"after"==e?t.after():"prev"==e?t.prev():"next"==e?t.next():"box"==e?$("#cboxLoadedContent>.box-page").last():$(e)}function sgShowBox(e,t,a,o){var n,i={fixed:!0,opacity:.5,width:"95%",maxHeight:"95%",maxWidth:"95%",className:"colorbox"+("full"==t.data("width")?" -full":""),onComplete:function(){}},l=$("#cboxLoadedContent"),s=!1,r=window.scrollX,d=window.scrollY;if(a=$.extend(i,a),t instanceof jQuery&&(s=!0,n=t.attr("href")?t.attr("href"):t.attr("action"),t.data("className")&&t.data("className",a.className+" "+t.data("className")),a=$.extend(a,t.data(),t.data("box"))),"boxwidth"in a&&(a.width=a.boxwidth),"boxheight"in a&&(a.height=a.boxheight),a.clearBoxContent&&(sgBoxPage=0,l.empty()),a.onClosed=function(){sgBoxPage=0,window.onscroll=function(){},isAndroidWebViewReady&&Android.reloadWebView("Yes")},window.onscroll=function(){window.scrollTo(r,d)},s&&"img"===t.data("rel")){sgBoxPage=0;var c=t.data("group");a.open=!0,$('.sg-action[data-group="'+c+'"]').each(function(e){$(this).colorbox(a)}),t.colorbox(a),o.stopPropagation()}else if(l.length){debugSG&&console.log("Show Link In Current Box"),debugSG&&console.log("Link Url =",n),l.find(".box-page").hide(),sgBoxPage++;var u='<div class="box-page" data-page="'+sgBoxPage+'" data-url="'+n+'">'+e+"</div>";l.append(u)}else sgBoxPage++,a.html='<div class="box-page" data-page="'+sgBoxPage+'" data-url="'+n+'">'+e+"</div>",$.colorbox(a)}function sgUpdateData(e,t,a,o={}){if(null!=t){var n,i=t.split(":"),l=i[0];if(i.length>1&&(t=i[1]),debugSG&&console.log("Type = "+l+" Target = "+t),"none"==l);else if("console"==l)console.log(e);else if("notify"==l)notify("notify"!=t?t:e,2e4);else if("box"==l)sgShowBox(e,a,{clearBoxContent:"clear"==t}),isAndroidWebViewReady&&Android.reloadWebView("No");else if("close"==l)$.colorbox.close();else if("reload"==l)window.location=document.URL;else if("this"==l)a.html(e);else if("parent"==l)(n="parent"==t?a.parent():a.closest(t)).html(e);else if("replace"==l)(n="replace"==t?a:a.closest(t).length?a.closest(t):$(t)).replaceWith(e);else if("after"==l)(n="after"==t?a:$(t)).after(e);else if("append"==l)(n="append"==t?a:$(t)).append(e);else if("refresh"==l){var s=(n="refresh"==t?$("#main"):$(t)).data("url")?n.data("url"):document.URL;s&&$.post(s,function(e){n.html(e)})}else $(t).html(e)}}function sgActionDone(doneData,$this,data,options={}){void 0!==doneData&&doneData.split("|").map(function(doneItem){var doneExplode=doneItem.trim().split(":"),doneType=doneExplode[0].split("->")[0],doneAction=doneExplode[0].split("->")[1],doneTarget=doneExplode.length>1?doneExplode[1].trim():"";switch(""==doneTarget&&(doneTarget="#main"),console.log(data),doneType){case"notify":notify(doneExplode[1],2e4);break;case"javascript":eval(doneTarget);break;case"function":let fn="(function"+doneTarget+")($this,data)";eval(fn);break;case"callback":var callback=doneTarget.trim();doneTarget&&"function"==typeof window[doneTarget]&&window[doneTarget]($this,data);break;case"back":var $boxElement=$("#cboxLoadedContent");if($boxElement.length){var $boxPage=$(".box-page");$boxPage.length<=1?($.colorbox.close(),isAndroidWebViewReady&&Android.reloadWebView("Yes")):($boxElement.children(".box-page").last().remove(),$boxElement.children(".box-page").last().show())}break;case"close":var $boxElement=$("#cboxLoadedContent");if($boxElement.length)$.colorbox.close();else{if(isFlutterInAppWebViewReady)return void window.flutter_inappwebview.callHandler("closeWebView");if(isAndroidWebViewReady)return Android.closeWebView(),!1}break;case"moveto":if("#"===doneExplode[1].substr(0,1))$(doneExplode[1]).length&&$("html,body").animate({scrollTop:$(doneExplode[1]).offset().top-64},"slow");else{var moveto=doneExplode[1].split(",");window.scrollTo(parseInt(moveto[0]),parseInt(moveto[1]))}break;case"remove":var $ele=sgFindTargetElement(doneTarget,$this);$ele.remove();break;case"reload":var refreshUrl=doneExplode.length>1?doneExplode[1]:document.URL;refreshUrl=refreshUrl.replace(/\{\{(\w+)\}\}/g,function(e,t){return data[t]}),window.location=refreshUrl;break;case"load":var $ele=sgFindTargetElement(doneTarget,$this),loadUrl=doneExplode.length>2?doneExplode[2]:$ele.data("url")?$ele.data("url"):document.URL;loadUrl&&($ele.length||"none"==doneTarget)&&(loadUrl=loadUrl.replace(/\{\{(\w+)\}\}/g,function(e,t){return data[t]}),$.post(loadUrl,function(e){switch(doneAction){case"replace":$ele.replaceWith(e);break;case"before":$ele.before(e);break;case"after":$ele.after(e);break;case"append":$ele.append(e);break;case"prepend":$ele.prepend(e);break;case"prev":$ele.prev().html(e);break;case"next":$ele.next().html(e);break;case"clear":"box"==doneTarget&&sgShowBox(e,$this,{clearBoxContent:!0});break;default:$ele.html(e)}"box"==doneTarget&&$this.data("boxResize")&&$.fn.colorbox.resize({})}).fail(function(){console.log("Refresh url fail")}))}})}function sgWebViewDomProcess(e){var t=$(e);sgActionDone(t.data("webviewResume"),t)}function drawChart(e){var t=$(e),a=t.attr("id"),o=t.find("h3").text(),n=t.data("chartType"),i=$(e).find("table"),l=[],s=[],r={},d={};null==n&&(n="col"),console.log("::SG-CHART "+n+" of "+a);var c={pointSize:4,allowHtml:!0,pieHole:.4,vAxis:{viewWindowMode:"explicit"},hAxis:{textStyle:{fontSize:10}},annotations:{textStyle:{fontSize:9}}};2==t.data("series")&&(c.series={0:{targetAxisIndex:0},1:{targetAxisIndex:1}});r=$.extend(c,t.data("options"));t.data("value")||$.each(i.find("tbody>tr"),function(e,t){var a=$(this),o=[];$.each(a.find("td"),function(t,a){var i,l=$(this),r=l.attr("class").split(":");0==e&&s.push([r[0],r[1],null==r[2]?"":r[2]]),i="string"==r[0]?l.text():Number(l.text().replace(/[^\d\.]/g,"")),o.push(i),"guage"==n&&(d[l.attr("class")]=i)}),l.push(o)}),google.charts.load("current",{packages:["corechart","line","gauge"]}),google.charts.setOnLoadCallback(function(){o&&(r.title=o);let e=null;if(t.data("value"))e=google.visualization.arrayToDataTable(t.data("value"));else if("guage"==n){let t=[];t.push(["Label","Value"]),$.each(l,function(e){t.push([l[e][0],l[e][1]]),l[e][2]&&(r.max=l[e][2]),"redFrom"in d&&(r.redFrom=d.redFrom),"redTo"in d&&(r.redTo=d.redTo),"yellowFrom"in d&&(r.yellowFrom=d.yellowFrom),"yellowTo"in d&&(r.yellowTo=d.yellowTo),"greenFrom"in d&&(r.greenFrom=d.greenFrom),"greenTo"in d&&(r.greenTo=d.greenTo),"string:redColor"in d&&(r.redColor=d["string:redColor"])}),e=google.visualization.arrayToDataTable(t)}else e=new google.visualization.DataTable,$.each(s,function(t){"role"==s[t][2]?e.addColumn({type:s[t][0],role:"annotation"}):e.addColumn(s[t][0],s[t][1])}),e.addRows(l);var i,c=document.getElementById(a);"line"==n?i=new google.charts.Line(c):"bar"==n?i=new google.visualization.BarChart(c):"col"==n?i=new google.visualization.ColumnChart(c):"pie"==n?i=new google.visualization.PieChart(c):"combo"==n?i=new google.visualization.ComboChart(c):"guage"==n&&(i=new google.visualization.Gauge(c));if(t.data("callback")){let e=t.data("callback");if(e&&"function"==typeof window[e]){let t=window[e];google.visualization.events.addListener(i,"ready",t)}}t.data("image")&&google.visualization.events.addListener(i,"ready",function(){var e=i.getImageURI();document.getElementById(t.data("image")).src=e});i.draw(e,r)})}window.addEventListener("flutterInAppWebViewPlatformReady",function(e){isFlutterInAppWebViewReady=!0}),function(e){e.fn.openWebview=function(t,a={}){var o=e(this),n=o.data(),i=o.attr("href"),l=o.data("webview");return self.doAction=function(){if(!isAndroidWebViewReady&&!isFlutterInAppWebViewReady)return!1;var e=JSON.stringify(n);if("browser"==l)isFlutterInAppWebViewReady||isAndroidWebViewReady&&Android.openBrowser(i,e);else if("googlemap"==l)isFlutterInAppWebViewReady||isAndroidWebViewReady&&Android.openGoogleMap(i,e);else if("server"==l)debugSG&&console.log("Change to Server to "+n.server),isFlutterInAppWebViewReady||isAndroidWebViewReady&&Android.useServer(n.server);else{if(!l)return!1;if(n.webviewTitle=n.webview,e=JSON.stringify(n),i=/^((http|https|ftp):\/\/)/.test(i)?i:document.location.origin+i,isFlutterInAppWebViewReady){const e=[i,n.webviewTitle,n];window.flutter_inappwebview.callHandler("showWebView",...e)}else isAndroidWebViewReady&&Android.showWebView(i,e)}},o.actionComplete=!1!==self.doAction(),o.version=function(){return console.log("$.sgAction version is 0.01"),o},o},e(document).on("click","[data-webview]",function(t){var a=e(this).openWebview(t,{}).actionComplete;return debugSG&&console.log("Mobile App WebView 0.01 result is ",a),!a||(t.stopImmediatePropagation(),!1)})}(jQuery),function(e){e.fn.sgAction=function(t,a={}){var o,n,i=e(this),l=i.data(),s=l.options,r=i.attr("href"),d=l.rel,c=l.ret,u={},p=e("#cboxLoadedContent"),f=null==l.confirm||l.confirmed,g=l.callback;"javascript:void(0)"==r&&(r=l.url),console.log("$.sgAction version 1.01 start"),d&&(o=d.split("->")[1],d=d.split("->")[0]);var h={result:"html",container:e(this),loadurl:l.loadurl,silent:!1,callback:!1},m=e.extend({},e.fn.sgAction.defaults,h,s,a);return self.doAction=function(){if(console.log("relTarget = "+d+" Action = "+o),f){if(l.confirmed&&(i.removeData("confirmed"),u.confirm="yes"),"box"==d&&"clear"==o&&(sgBoxPage=0,p.empty()),l.before&&sgActionDone(l.before,i),"close"==d){if(0!=i.closest(".sg-dropbox.box").length)return e(".sg-dropbox.box").children("div").hide(),void e(".sg-dropbox.box.active").removeClass("active");if(e("#cboxLoadedContent").length)return void e.colorbox.close();if(isFlutterInAppWebViewReady)return void window.flutter_inappwebview.callHandler("closeWebView");if(isAndroidWebViewReady)return void Android.closeWebView();d=void 0}else{if("back"==d&&p.length)return void(e(".box-page").length<=1?(e.colorbox.close(),isAndroidWebViewReady&&console.log("ANDROID Back")):(p.children(".box-page").last().remove(),p.children(".box-page").last().show()));if("img"==d)return void sgShowBox(null,i,null,t)}if(null==d&&null==c){var a="{}"!=JSON.stringify(u),s=i.attr("href");return s+=a?(-1==s.indexOf("?")?"?":"&")+e.param(u):"",window.location=s,!0}if(r&&"#"==r.substr(0,1)){console.log("LOAD FROM DOM "+r);var h=null;return e(r).length&&(h=e(r).get(0).innerHTML),sgUpdateData(h,d,i),void sgActionDone(l.done,i,n)}debugSG&&console.log("Load from url "+r),m.silent||notify(m.indicator),e.post(r,u,function(t){if(n=t,notify(),m.silent||console.log("Load completed."),c?(debugSG&&console.log("Return URL "+c),e.post(c,function(e){sgUpdateData(e,d,i),notify()})):sgUpdateData(t,d,i),l.removeparent){var a=l.removeparent;(a.charAt(0).match(/\.|\#/i)?e(a):i.closest(a)).remove()}m.callback&&m.callback(i,t),g&&"function"==typeof window[g]?window[g](i,t):g&&(window.location=g)}).fail(function(e){let t="ERROR : "+e.responseText+"<br />( "+e.status+" : "+e.statusText+" )";notify(t)}).done(function(){sgActionDone(l.done,i,n)})}},self.test=function(){console.log("THIS IS A TEST")},i.actionResult=!1!==self.doAction(),i.version=function(){return console.log("$.sgAction version is 1.01"),i},i},e.fn.sgForm=function(){return this},e.fn.sgAction.defaults={indicator:"LOADING",tooltip:"คลิกเพื่อแก้ไข",cssclass:"inlineedit",width:"none",height:"none",cancelcssclass:"btn -link -cancel",submitcssclass:"btn -primary",showButtonPanel:!0,event:"edit",inputcssclass:""},e(document).on("click",".sg-action",function(t){return!e(this).sgAction(t,{aTestOpt:"This is test option"}).actionResult})}(jQuery),$(document).on("submit","form.sg-form",function(e){var t,a=$(this),o=a.data("rel"),n=a.data("ret"),i=a.data("complete"),l=a.data("checkvalid"),s=a.data("silent"),r="",d="";return console.log("sg-form :: Submit"),(!l||(console.log("Form Check input valid start."),a.find(".require, .-require").each(function(e){var t=$(this);if("text"!=t.attr("type")&&"password"!=t.attr("type")&&"hidden"!=t.attr("type")&&"TEXTAREA"!=t.prop("tagName")||""!=t.val().trim()?"SELECT"!=t.prop("tagName")||0!=t.val()&&-1!=t.val()&&""!=t.val()?"radio"!=t.attr("type")&&"checkbox"!=t.attr("type")||$("input[name='"+t.attr("name")+"']:checked").val()||(d=(r=t).closest("div").children("label").first().text()):(r=t,d='กรุณาเลือกข้อมูลในช่อง " '+$("label[for="+r.attr("id")).text()+' "'):(r=t,d='กรุณาป้อนข้อมูลในช่อง " '+$("label[for="+r.attr("id")).text()+' "',t.focus()),r){var a=r.attr("id");return $("#"+a).isOnScreen()||$("html,body").animate({scrollTop:r.offset().top-100},"slow"),notify(d),!1}}),!r))&&(null==o||(s||notify("PROCESSING"),debugSG&&console.log("Send form to "+a.attr("action")),debugSG&&console.log("Result to "+o),a.hasClass("-upload")?(debugSG&&console.log("SOFTGANZ UPLAOD FILE"),a.ajaxSubmit({success:function(t){debugSG&&console.log("SG-FORM.-UPLOAD ajaxSubmit upload file complete."),"remove"==i?a.remove():"close"!=i&&"closebox"!=i||(0!=$(e.rel).closest(".sg-dropbox.box").length?($(".sg-dropbox.box").children("div").hide(),$(".sg-dropbox.box.active").removeClass("active")):$.colorbox.close()),n?$.post(n,function(e){sgUpdateData(e,o,a),notify(),sgActionDone(a.data("done"),a,e)}):(sgUpdateData(t,o,a),sgActionDone(a.data("done"),a,t)),"notify"!=o&&notify(),a.replaceWith(a.clone(!0))},error:function(e){notify(e.statusText),debugSG&&console.log(e),sgUpdateData(e.responseText,o,a)}})):$.post(a.attr("action"),a.serialize(),function(l){if(t=l,debugSG&&console.log("Form submit completed and send output to "+o),"remove"==i?a.remove():"close"!=i&&"closebox"!=i||(0!=$(e.rel).closest(".sg-dropbox.box").length?($(".sg-dropbox.box").children("div").hide(),$(".sg-dropbox.box.active").removeClass("active")):$.colorbox.close()),n)debugSG&&console.log("Return URL "+n),$.post(n,function(e){sgUpdateData(e,o,a),notify()});else if(sgUpdateData(l,o,a),a.data("moveto")){var s=a.data("moveto").split(",");window.scrollTo(parseInt(s[0]),parseInt(s[1]))}"notify"!=o.substring(0,6)&&notify();var r=a.data("callback");r&&"function"==typeof window[r]?window[r](a,l):r&&(window.location=r)},null==a.data("dataType")?null:a.data("dataType")).fail(function(e){let t="ERROR : "+e.responseText+"<br />( "+e.status+" : "+e.statusText+" )";return notify(t),debugSG&&console.log(e),!0}).done(function(){sgActionDone(a.data("done"),a,t)}),!1))}).on("keydown","form.sg-form input:text",function(e){var t=$(this).closest("form").find("input:text"),a=t.length;if(13==e.keyCode){e.preventDefault();var o=t.index(this)+1;return o<a&&t[o].focus(),!1}}),function(e){var t,a=0,o=0;e.fn.sgInlineEdit=function(n,i={}){if(void 0===e.fn.editable)return void console.log("ERROR :: $.editable is not load");if("disable"===n)return;if("enable"===n)return;if("destroy"===n)return;let l=e(this),s=l.closest(".sg-inline-edit"),r=s.data("updateUrl"),d=l.data("type"),c=l.data("callback");if(t=!!s.data("debug"),"money"==d||"numeric"==d||"text-block"==d)d="text";else if("radio"==d||"checkbox"==d)var u=l.is(":checked")?l.val():"";else{if("link"==d)return;""!=d&&null!=d||(d="text",l.data("type","text"))}let p={type:d,result:"json",container:e(this),onblur:l.data("onblur")?l.data("onblur"):"submit",data:function(e,t){return l.data("data")?l.data("data"):null!=l.data("value")?l.data("value"):"..."==e?"":e},loadurl:l.data("loadurl"),before:function(){var e=l.data("options"),t=null!=e&&e.hasOwnProperty("onBefore")?e.onBefore:null;t&&"function"==typeof window[t]&&window[t](l,s)},cancel:"yes"==e(this).data("button")?'<button class="btn -link -cancel"><i class="icon -cancel -gray"></i><span>ยกเลิก</span></button>':null,submit:"yes"==e(this).data("button")?'<button class="btn -primary"><i class="icon -save -white"></i><span>บันทึก</span></button>':null,placeholder:e(this).data("placeholder")?e(this).data("placeholder"):"..."};var f=l.data("options"),g=e.extend({},e.fn.sgInlineEdit.defaults,p,i,f);return"textarea"==l.data("type")?g.inputcssclass="form-textarea":"text"==l.data("type")?g.inputcssclass="form-text":"numeric"==l.data("type")?g.inputcssclass="form-text -numeric":"money"==l.data("type")?g.inputcssclass="form-text -money":"email"==l.data("type")?g.inputcssclass="form-text -email":"url"==l.data("type")?g.inputcssclass="form-text -url":"autocomplete"==l.data("type")?g.inputcssclass="form-text -autocomplete":"select"==l.data("type")&&(g.inputcssclass="form-select"),l.editable(function(e,t){return _validValue(l,e)?(self.save(l,e,c),e):(notify("ข้อมูลไม่อยู่ในช่วงที่กำหนด"),l.data("value"))},g).trigger("edit"),self._validValue=function(e,t){return"numeric"!=e.data("ret")||(t=t.replace(/[^0-9.\-]+|\.(?!\d)/g,""),!(null!=e.data("minValue")&&1*t<1*e.data("minValue"))&&!(null!=e.data("maxValue")&&1*t>1*e.data("maxValue")))},self.save=function(n,i,l){if(void 0===r)return console.log("POSTURL UNDEFINED"),void notify("ข้อมูลปลายทางสำหรับบันทึกข้อมูลผิดพลาด");var d=e.extend({},s.data(),n.data());delete d.options,delete d.data,delete d["event.editable"],delete d.uiAutocomplete,d.action="save",d.value=i.replace(/\"/g,'"'),g.var&&(d[g.var]=d.value),n.data("value",d.value),a++,o++,notify("กำลังบันทึก กรุณารอสักครู่...."+(t?"<br />Updating : pending = "+a+" To = "+r+"<br />":"")),s.find(".inline-edit-field").addClass("-disabled"),e.post(r,d,function(i){if(a--,s.find(".inline-edit-field").removeClass("-disabled"),"string"==typeof i){var l=i;(i={}).value=d.value,t&&(i.msg=l)}if("refresh"==d.ret)window.location=window.location;else if("autocomplete"==n.data("type"))n.data("value",d.value),n.html("<span>"+i.value+"</span>");else if("radio"==n.data("type"));else if("checkbox"==n.data("type"));else if("select"==n.data("type")){var r;r=n.data("data")?n.data("data")[i.value]:i.value,n.html("<span>"+r+"</span>")}else n.html("<span>"+(null==i.value?'<span class="placeholder -no-print">'+g.placeholder+"</span>":i.value)+"</span>");var c="";d.tr!=i.tr&&(0==i.tr&&(i.tr=""),e('[data-group="'+d.group+'"]').data("tr",i.tr),c="Replace tr of group "+d.group+" with "+i.tr),notify((i.error?i.error:i.msg?i.msg:"")+(t&&i.debug?'<div class="-sg-text-left" style="white-space: normal;">Update queue = '+o+", Update pending = "+a+"<br />PARAMETER : group = "+d.group+", FIELD = "+d.fld+", TRAN = "+d.tr+", VALUE = "+i.value+"<br />DEBUG : "+i.debug+"<br />Return : TRAN = "+i.tr+"<br />"+c+"</div>":""),t?3e5:5e3),g.done&&sgActionDone(g.done,n,i);var u=g.callback?g.callback:n.data("callback");debugSG&&console.log("CALLBACK ON COMPLETE -> "+u+(u?"()":"")),u&&("function"==typeof window[u]?window[u](n,i,s):"silent"==g.callbackType?e.get(u,function(){}):window.location=u)},g.result).fail(function(e){notify("ERROR ON POSTING. Please Contact Admin.")}).done(function(e){sgActionDone(n.data("done"),n,e),console.log("$.sgInlineEdit DONE!!!")})},"radio"!=d&&"checkbox"!=d||self.save(l,u,c),{getVersion:function(){return"1.01"},update:function(e,t,a){self.save(e,t,a)}}},e.fn.sgInlineEdit.defaults={indicator:'<div class="loader -rotate"></div>',tooltip:"คลิกเพื่อแก้ไข",cssclass:"inlineedit",width:"none",height:"none",var:null,cancelcssclass:"btn -link -cancel",submitcssclass:"btn -primary",showButtonPanel:!0,indicator:"SAVING",event:"edit",inputcssclass:"",autocomplete:{},datepicker:{}},e(document).on("click",".sg-inline-edit .inline-edit-field:not(.-readonly)",function(){console.log("$.sgInlineEdit version 1.01 start"),e(this).sgInlineEdit()}),e(document).on("keydown",".sg-inline-edit .inline-edit-field",function(t){if(9==t.keyCode){e(this).closest(".sg-inline-edit");var a="",o=e(".inline-edit-field").index(this);return a=o==e(".inline-edit-field").length-1?e(".inline-edit-field:first"):e(".inline-edit-field").eq(o+1),e(this).find("input").blur(),e(a).trigger("click"),!1}}),e(document).ready(function(){void 0!==e.fn.editable&&(e.editable.addInputType("checkbox",{}),e.editable.addInputType("radio",{}),e.editable.addInputType("autocomplete",{element:e.editable.types.text.element,plugin:function(t,a){e(a).attr("autocomplete","off");var o={target:"",source:function(a,o){var n=t.autocomplete.query,i={};i.q=a.term,e.get(n,i,function(t){o(e.map(t,function(e){return e}))},"json")},minLength:2,dataType:"json",cache:!1,focus:function(e,t){e.preventDefault()},select:function(o,n){this.value=n.item.label;var i=t.autocomplete.target;if(console.log("targetValue",i),i)for(var l in"string"==typeof i&&(i=JSON.parse('{"'+i+'": "value"}')),i){var s=n.item[i[l]];console.log("key = "+l+" , value = item.ui."+s),"#"==l.substring(0,1)||"."==l.substring(0,1)?e(l).val(n.item.value):(e(a).data(l,s),console.log("data of key "+l+" = "+e(a).data(l)))}e(this).submit()}};t.autocomplete=e.extend({},o,t.autocomplete),e("input",this).autocomplete(t.autocomplete).autocomplete("instance")._renderItem=function(t,a){return"..."==a.value?e('<li class="ui-state-disabled -more"></li>').append(a.label).appendTo(t):e("<li></li>").append("<a><span>"+a.label+"</span>"+(null!=a.desc?"<p>"+a.desc+"</p>":"")+"</a>").appendTo(t)}}}),e.editable.addInputType("datepicker-old",{element:function(t,a){var o=e('<input class="form-text -datepicker" />');return o.attr("autocomplete","off"),t.datepicker?o.datepicker(t.datepicker):o.datepicker(),t.datepicker.format&&o.datepicker("option","dateFormat",t.datepicker.format),e(this).append(o),o},submit:function(t,a){var o,n=e("input",this).datepicker("getDate");o=t.datepicker.format?e.datepicker.formatDate(t.datepicker.format,new Date(n)):n,e("input",this).val(o)},plugin:function(e,t){e.onblur="submit"}}),e.editable.addInputType("datepicker",{element:function(t,a){var o=e('<input class="form-text -datepicker" />');o.attr("autocomplete","off");var n={format:"dd/mm/yy",monthNames:thaiMonthName,beforeShow:function(t){console.log("INLINE DATE BEFORE SHOW"),e(".ui-datepicker:visible").css({top:"+=5"})},open:function(){console.log("INLINE DATEOPEN"),e(".ui-datepicker:visible").css({top:"+=5"})},onSelect:function(){e(this).submit()}};return t.datepicker=e.extend({},n),o.datepicker(t.datepicker),t.datepicker.format&&o.datepicker("option","dateFormat",t.datepicker.format),e(this).append(o),o},submit:function(t,a){var o,n=e("input",this).datepicker("getDate");o=t.datepicker.format?e.datepicker.formatDate(t.datepicker.format,new Date(n)):n,e("input",this).val(o),e("input",this).datepicker("hide")},plugin:function(e,t){e.onblur="nothing"}}))})}(jQuery),function(e){e(document).on("click",".sg-expand",function(){let t=e(this),a=e(this).children();if(t.data("rel"))e(t.data("rel")).toggle();else{e(this).closest(".widget-listtile").next().toggle()}"expand_less"==a.text()?a.text("expand_more"):"expand_more"==a.text()&&a.text("expand_less")})}(jQuery),function(e){let t=0;e.fn.sgDrawReport=function(t,a={}){let o=e(this),n=o.closest("form"),i=o.closest(".sg-drawreport"),l=i.data("query"),s=i.data("callback"),r=i.data("options");console.log("$.sgDrawReport version 0.10 init");let d={dataType:"json",container:e(this),callback:!1},c=e.extend({},e.fn.sgDrawReport.defaults,d,r,a);return self.startDrawReport=function(t){console.log("$.sgDrawReport 0.10 start draw report");i.find('input[name="debug"]:checked').length>0&&t.process;if("html"==c.dataType){return void e(i.data("showHtml")).html(t)}let a=i.find("#report-output-debug").empty();t.debug&&t.process&&t.process.forEach(function(t){a.append(e("<div></div>").html(t))}),i.data("showChart")&&showChart(t),i.data("showSummary")&&showSummary(t),i.data("showItems")&&showItems(t),i.data("showHtml")&&showHtml(t)},self.showChart=function(t){let a=e(i.data("showChart")),o=i.find("#graphtype").val(),n=[["รายการ","จำนวน"]];if(null!=t.summary&&0!=a.length){t.summary.forEach(function(e,t){n.push([e.label,e.project])});var l=google.visualization.arrayToDataTable(n),s={title:t.title,hAxis:{title:"H Axis",titleTextStyle:{color:"black"}},vAxis:{title:"Y Axis",minValue:0},isStacked:!1};("Bar"==o?new google.visualization.BarChart(document.getElementById("report-output-chart")):"Col"==o?new google.visualization.ColumnChart(document.getElementById("report-output-chart")):"Line"==o?new google.visualization.LineChart(document.getElementById("report-output-chart")):new google.visualization.PieChart(document.getElementById("report-output-chart"))).draw(l,s)}},self.showSummary=function(t){var a=e(i.data("showSummary"));if(a.empty(),null!=t.summary&&0!=a.length){var o=e("<table></table>").addClass("item"),n=e("<thead></thead>");if(Object.keys(t.summaryFields).forEach(function(a){n.append(e("<th></th>").text(t.summaryFields[a]))}),o.append(n),t.summary.forEach(function(a,n){var i=e("<tr></tr>").addClass("row");Object.keys(t.summaryFields).forEach(function(t){let o=a[t];"number"==typeof o&&parseInt(o)!=o&&(o=thousandsSeparators(o)),i.append(e("<td></td>").addClass("col "+("label"==t?"":"-center")).text(o))}),o.append(i)}),t.total){var l=e("<tfoot></tfoot").append(e("<tr></tr>"));Object.keys(t.summaryFields).forEach(function(a){"label"==a?l.append("<td>รวมทั้งสิ้น</td>"):"%"==t.summaryFields[a]?l.append(e("<td></td>").addClass("col -center").text("100%")):l.append(e("<td></td>").addClass("col -center").text(t.total[a]))}),o.append(l)}a.append(o)}},self.showItems=function(t){let a=e(i.data("showItems")),o=!1;if(a.empty(),null!=t.items&&0!=a.length&&(o=t.items.length>0)){var n=e("<a/>");n.addClass("btn").html('<i class="icon -material">cloud_download</i><span>EXPORT</span>').attr("href","javascript:void(0)").attr("onClick",'export2excel("trans")'),a.append(e("<nav></nav>").addClass("nav -page -table-export -sg-text-right").append(n));var l=e("<table></table>").addClass("item").attr("id","detail-list"),s=e("<thead></thead>").append(e("<tr></tr>"));Object.keys(t.itemsFields).forEach(function(a){s.append(e("<th></th>").text(t.itemsFields[a]))}),l.append(s);var r=e("<tbody></tbody>");t.items.forEach(function(a,o){let n,i=e("<tr></tr>").addClass("row"),l=e("<a/>");"object"==typeof a.config.link&&(n=a.config.link.field,l.attr("href",a.config.link.href).text(a[a.config.link.field]).addClass("sg-action").attr("target","_blank").data("rel","box").data("width",640).data("webview",a.fullname)),Object.keys(t.itemsFields).forEach(function(t){i.append(e("<td></td>").html(t==n?l:a[t]))}),r.append(i)}),l.append(r),a.append(l)}},self.showHtml=function(t){let a=e(i.data("showHtml"));a.empty(),null!=t.html&&a.html(t.html)},o.doAction=function(){(o.hasClass("-submit-group")?(o.closest("ul").children().removeClass("-active"),o.closest("li").addClass("-active"),e("#reporttype").val(o.attr("href").slice(1))):o.hasClass("-graph")&&e("#graphtype").val(o.val()),notify("LOADING"),e.post(l,n.serialize(),function(e){notify()},c.dataType).fail(function(e){notify("ERROR ON POSTING")}).done(function(e){debugSG&&e.debug&&console.log("DONE WITH data = ",e),s&&"function"==typeof window[s]?window[s](o,e):startDrawReport(e)}),null!=t)&&("checkbox"!=e(t.target).attr("type")&&t.preventDefault());return o},o.showChart=function(e){return showChart(e),o},o.showSummary=function(e){return showSummary(e),o},o.showItems=function(e){return showItems(e),o},o.showHtml=function(e){return showHtml(e),o},o.version=function(){return console.log("$.sgDrawReport version is 0.10"),o},o.makeFilterBtn=function(){let t=i.find("#toolbar-report-filter>.-item");t.empty(),e(".sg-drawreport .-filter-checkbox:checked").each(function(a){t.append('<span class="" data-src="'+e(this).attr("id")+'">'+e(this).closest("label").text()+'<a class="x-submit"><i class="icon -material -sg-16">close</i></a></span>')})},o},e.fn.sgDrawReport.defaults={indicator:"LOADING"},e(document).on("click",".sg-drawreport>form>.toolbar.-report>.-filter>.-select>.-item a",function(){var t=e(this).closest("span").data("src");e("#"+t).prop("checked",!1);let a=e("#"+t).closest("li").find(".-amt");a.html(a.text()-1);e(this).sgDrawReport(event,{aTestOption:"This is test option"}).doAction();e(this).parent().remove()}),e(document).on("click",".sg-drawreport .-submit",function(t){return e(this).sgDrawReport(t,{aTestOption:"This is test option"}).doAction()}),e(document).on("change",".sg-drawreport .-filter-checkbox",function(){let t=0;e(this).closest(".-checkbox").find(".-filter-checkbox:checked").each(function(e){t++}),e(this).closest("li").find(".-check-count>.-amt").html(t).parent().removeClass("-hidden").addClass(t>0?"":"-hidden"),e(this).sgDrawReport().makeFilterBtn()}),e(document).on("click",".sg-drawreport .group-nav",function(){let a=e(this),o=a.hasClass("-left"),n=a.closest(".-group"),i=n.width()-60,l=n.find("ul>li").width(),s=Math.floor(i/l),r=Math.ceil(n.find("ul").width()/i);o?t>0&&t--:t<r-1&&t++;let d=t*l*s+(s*t+1)-1;n.find("ul").animate({left:-d+"px"},"fast")})}(jQuery),$(document).on("click",".sg-tabs>.ui-tab>.ui-item>a, .sg-tabs>ul.tabs>li>a, .sg-tabs>ul>li>a",function(e){var t=$(this),a=t.closest(".sg-tabs"),o=t.attr("href");if(t.closest("ul").children("li").removeClass("-active"),t.closest("li").addClass("-active"),sgTabIdActive=t.attr("id"),null!=t.attr("target"))return!0;null==o||"javascript:void(0)"==o||("#"==o.left(1)?(a.children("div").hide(),a.children(t.attr("href")).show()):t.hasClass("sg-action")||(notify("LOADING"),console.log("LOAD TAB"),$.post(o,function(e){a.children("div").html(e),notify()})));var n=t.data("callback");return n&&"function"==typeof window[n]?window[n](t,html):n&&(window.location=n),!1}),$(document).on("click",".sg-dropbox>a",function(){var e=$(this).parent(),t=$(this).next(),a=e.find(".sg-dropbox--content");$(".sg-dropbox.click").not($(this).parent()).each(function(){$(this).children("div").hide()}),"box"==e.data("type")?(e.css("display","block").addClass("active"),null!=e.data("url")?(a.html("LOADING"),t.show(),$.get(e.data("url"),function(e){a.html(e)})):t.show()):"click"==e.data("type")?t.show():t.toggle();var o=$(this).offset(),n=t.width(),i=$(document).width(),l=0;if(o.left+n>i){l=i-o.left-$(this).width()-8;t.css({rightside:l+"px"})}return!1}).on("click","body",function(e){0==$(e.target).closest(".sg-dropbox").length&&$(".sg-dropbox.click").children("div").hide(),0===$(e.target).closest(".sg-dropbox.box").length&&($(".sg-dropbox.box").children("div").hide(),$(".sg-dropbox.box.active").removeClass("active"))}),$(document).on("focus",".sg-datepicker",function(e){console.log("SG-DATEPICKER Start"),$(this).attr("autocomplete","off");let t={clickInput:!0,dateFormat:"dd/mm/yy",altFormat:"yy-mm-dd",altField:"AAAA",disabled:!1,monthNames:thaiMonthName,beforeShow:function(e){$(this).data("previous",$(e).val()),$(".ui-datepicker:visible").css({top:"+=5"})},open:function(){},onSelect:function(e,t){if($(this).data("previous")!=e){if($(this).data("diff")){let t=$("#"+$(this).data("diff")),a=$(this);if(""==t.val())t.val(a.val());else{let a=0,o=864e5,n=($(this).data("previous")?$(this).data("previous"):e).split("/"),i=$(this).val().split("/"),l=t.val().split("/"),s=new Date(n[2],n[1]-1,n[0]),r=new Date(l[2],l[1]-1,l[0]),d=new Date(i[2],i[1]-1,i[0]);a=Math.round((r-s)/o);let c=new Date(d);c.setDate(d.getDate()+a);let u=c.getDate(),p=c.getMonth()+1,f=c.getFullYear(),g="00",h=(g+u).slice(-g.length)+"/"+(g+p).slice(-g.length)+"/"+f;t.val(h)}}$(this).trigger("dateupdated")}let a=$(this).data("callback");if(a)if("submit"==a)$(this).closest("form").submit();else if("function"==typeof window[a])window[a](e,$(this));else{let e=a+"/";window.location=e}}},a=$.extend(t,$(this).data());$(this).datepicker(a)}),$(document).on("focus",".sg-address",function(e){var t=$(this);t.autocomplete({source:function(e,t){console.log("Search address of "+e.term),$.get(url+"api/address?q="+encodeURIComponent(e.term),function(e){t(e)},"json")},minLength:6,dataType:"json",cache:!1,select:function(e,a){this.value=a.item.label,console.log("Return Address : "+a.item.value),t.data("altfld")&&$("#"+t.data("altfld")).val(a.item.value);var o=t.data("callback");if(o)if("submit"==o)$(this).closest("form").trigger("submit");else if("function"==typeof window[o])window[o](t,a);else{var n=o+"/"+a.item.value;window.location=n}return!1}}).autocomplete("instance")._renderItem=function(e,t){return"..."==t.value?$('<li class="ui-state-disabled -more"></li>').append(t.label).appendTo(e):$("<li></li>").append("<a><span>"+t.label+"</span>"+(null!=t.desc?"<p>"+t.desc+"</p>":"")+"</a>").appendTo(e)}}),$(document).on("focus",".sg-autocomplete",function(e){var t=$(this),a=t.closest("form"),o=1;t.data("minlength")&&(o=t.data("minlength")),t.autocomplete({minLength:o,dataType:"json",cache:!1,source:function(e,a){var o={};o.n=t.data("item"),o.q=t.val(),notify("กำลังค้นหา"),$.get(t.data("query"),o,function(e){notify(),a(e);var o=t.data("renderComplete");if(o&&"function"==typeof window[o])return window[o](t)},"json")},open:function(){$(".ui-autocomplete:visible").css({top:"+=5"}),t.data("class")&&t.autocomplete("widget").addClass(t.data("class")),t.data("width")&&t.autocomplete("widget").css({width:t.data("width")})},focus:function(e,t){return!1},select:function(e,o){if(console.log("Select "+o.item.value),t.data("altfld")){var n="#"+t.data("altfld");a.find(n).length?a.find(n).val(o.item.value):$(n).val(o.item.value)}if(null!=t.data("select")){var i,l=t.data("select");if("object"==typeof l)for(i in l)$("#"+i).val(o.item[l[i]]);else"string"==typeof l&&t.val(o.item[l])}else t.val(o.item.label);var s=t.data("callback");if(s)if("submit"==s)$(this).closest("form").trigger("submit");else if("function"==typeof window[s])window[s](t,o);else{var r=s+"/"+o.item.value;window.location=r}return!1},response:function(e,a){var o=t.data("renderStart");o&&"function"==typeof window[o]&&window[o](t,a)}}).autocomplete("instance")._renderItem=function(e,a){var o=t.data("renderItem");return o&&"function"==typeof window[o]?window[o](t,e,a):"..."==a.value?$('<li class="ui-state-disabled -more"></li>').append(a.label).appendTo(e):$("<li></li>").append("<a><span>"+(null!=a.altLabel?a.altLabel:a.label)+"</span>"+(null!=a.desc?"<p>"+a.desc+"</p>":"")+"</a>").appendTo(e)}}),$(document).on("change","form.sg-upload .inline-upload",function(){var e=$(this),t=e.closest("form"),a=t.data("rel"),o=' class="'+(null!=t.data("class")?t.data("class"):"ui-item -hover-parent")+'"';if(isAndroidWebViewReady&&Android.showToast("กำลังอัพโหลดไฟล์"),console.log("sg-upload :: Inline upload file start and show result in "+a),t.data("before")){var n=t.data("before"),i="<"+n+o+'><div class="loader -rotate -center"></div></'+n+">",l=e.closest(n).before(i);console.log(l)}else notify('<div class="loader -rotate"></div> กำลังอัพโหลดไฟล์ กรุณารอสักครู่');t.ajaxForm({success:function(n){if(console.log("Inline upload file complete."),isAndroidWebViewReady&&Android.showToast("อัพโหลดไฟล์เรียบร้อบ"),a)if(t.data("append")){var i="<"+t.data("append")+o+">"+n+"</"+t.data("append")+">";$(a).append(i)}else if(t.data("prepend")){i="<"+t.data("prepend")+o+">"+n+"</"+t.data("prepend")+">";$(a).prepend(i)}else if(t.data("before"))l.prev().html(n);else if(t.data("after")){i="<"+t.data("after")+o+">"+n+"</"+t.data("after")+">";e.closest(t.data("after")).after(i)}else sgUpdateData(n,a,e);notify("ดำเนินการเสร็จแล้ว.",5e3),e.val(""),e.replaceWith(e.clone(!0)),"close"==t.data("done")&&$.colorbox.close()}}).submit()}),$(document).ready(function(){$(".sg-chart").each(function(e){drawChart(this)})}),$(document).on("change",".sg-changwat",function(){var e=$(this),t=e.closest("form"),a=(t.find(".sg-changwat"),t.find(".sg-ampur")),o=t.find(".sg-tambon"),n=t.find(".sg-village"),i=e.data("altfld");console.log("Get Ampur of "+e.val()),""==e.val()?a.val("").hide():a.val(""),o.val("").hide(),n.length&&n.val("").hide(),a.length&&(a[0].options.length=1),o.length&&(o[0].options.length=1),n.length&&(n[0].options.length=1),i&&t.find(i).val(e.val()),$.get(url+"api/ampur",{q:e.val()},function(e){e.length?a.show():a.hide();for(var t=0;t<e.length;t++)a.append($("<option></option>").text(e[t].label).val(e[t].ampur))},"json"),"submit"==e.data("change")&&t.submit()}),$(document).on("change",".sg-ampur",function(){var e=$(this),t=e.closest("form"),a=t.find(".sg-changwat"),o=t.find(".sg-ampur"),n=t.find(".sg-tambon"),i=t.find(".sg-village"),l=e.data("altfld");console.log("Get Tambon of "+e.val()),""==e.val()?n.val("").hide():n.val(""),i.val("").hide(),n.length&&(n[0].options.length=1),i.length&&(i[0].options.length=1),l&&t.find(l).val(a.val()+e.val()),$.get(url+"api/tambon",{q:a.val()+o.val()},function(e){e.length?n.show():n.hide();for(var t=0;t<e.length;t++)n.append($("<option></option>").text(e[t].label).val(e[t].tambon))},"json"),"submit"==e.data("change")&&t.submit()}),$(document).on("change",".sg-tambon",function(){let e=$(this),t=e.closest("form"),a=t.find(".sg-changwat"),o=t.find(".sg-ampur"),n=t.find(".sg-tambon"),i=t.find(".sg-village"),l=e.data("altfld");l&&(console.log("tambon altfld = "+l),t.find(l).val(a.val()+o.val()+e.val())),i.length&&(console.log("Get Village of "+e.val()),""==e.val()?i.val("").hide():i.val("").show(),i.length&&(i[0].options.length=1),$.get(url+"api/village",{q:a.val()+o.val()+n.val()},function(e){for(let t=0;t<e.length;t++)i.append($("<option></option>").text(e[t].label).val(e[t].village))},"json"),"submit"==e.data("change")&&t.submit())}),$(document).on("change",".sg-village",function(){var e=$(this),t=e.closest("form"),a=t.find(".sg-changwat"),o=t.find(".sg-ampur"),n=t.find(".sg-tambon");t.find(".sg-village");a.data("altfld")&&$(a.data("altfld")).val(a.val()+o.val()+n.val()+e.val()),"submit"==e.data("change")&&t.submit()});var sgDrawMap=function(e,t={}){var a,o,n=$.extend({},{gisDigit:14,zoom:9,center:[],drag:"pin",dropPin:!1,dropPinText:null,updateUrl:null,updatePara:null,updateIcon:null,mapCanvas:"#map-canvas",height:"100%",pin:[],markers:[],debug:!1,callback:!1},t);n.debug&&console.log(n);var i=$("#current-location .value"),l=n.updateUrl,s=!!n.pin.lat,r="",d=("map"==n.drag?"เลื่อนแผนที่":"ลากหมุด")+"เพื่อเปลี่ยนตำแหน่ง";$(".box-page").css({width:"100%",height:"100%",minWidth:"100%",minHeight:"100%"}),$(".page.-map").css({height:n.height,minWidth:"100%",minHeight:n.height}),$(n.mapCanvas).css({width:"100%",height:"100%",minWidth:"100%",minHeight:"100%"}),n.dropPin?s?notify(d,2e4):s||notify("คลิกบนแผนที่ตรงตำแหน่งที่ต้องการวางหมุด",2e4):s=!0;var c=new GMaps({div:n.mapCanvas,zoom:n.zoom,scrollwheel:!0,lat:n.center.lat,lng:n.center.lng,click:function(e){s||(notify(d,2e4),o=e.latLng.lat().toFixed(n.gisDigit)+","+e.latLng.lng().toFixed(n.gisDigit),a=f({lat:e.latLng.lat(),lng:e.latLng.lng()}),s=!0,new google.maps.InfoWindow({content:r}).open(c,a),i.text(o))}});"map"==n.drag&&c.addListener("center_changed",()=>{a&&(a.setPosition(c.getCenter()),p(c.getCenter().lat(),c.getCenter().lng()))});var u=function(e){if(null==l)return!1;var t=null==n.updatePara?{}:n.updatePara;t.location=e,n.debug&&console.log("SAVE Location "+l,t),$.post(l,t,function(t){var a="https://www.google.com/maps/place/"+e,o="geo:?q="+e;$("#googlemap").attr("href",a).removeClass("-hidden"),$("#googlenav").attr("href",o).removeClass("-hidden");var i=""!=e?"-active":"";n.updateIcon&&$(n.updateIcon).removeClass("-active").addClass(i),notify("บันทึกเรียบร้อย"+t,3e3)})};function p(e,t){var a=$("#current-location");a.find(".value").text(e.toFixed(n.gisDigit)+","+t.toFixed(n.gisDigit)),a.find(".show").text(e.toFixed(4)+","+t.toFixed(4))}function f(t){o=t.lat.toFixed(n.gisDigit)+","+t.lng.toFixed(n.gisDigit);var a='<nav class="nav -sg-flex"><a class="sg-action btn -link -cancel" href="#current-location" data-rel="none" data-title="ลบหมุด" data-confirm="ลบหมุด กรุณายืนยัน?" data-done="javascript:'+e+'.clearMap()"><i class="icon -material">cancel</i><span>ลบหมุด</span></a><a class="btn -primary" onClick=\''+e+'.locationUpdate($("#current-location>.value").text());return false;\'><i class="icon -material">done</i><span>บันทึกตำแหน่ง</span></a></nav>',i="";return t.currentLocation&&null!=n.locationText?i=n.locationText:n.pin&&null!=n.pin.content&&(i=n.pin.content),r='<div class="map-info">'+i+(n.updateUrl?a:"")+'<div id="current-location" class="current-location">พิกัด <span class="value -hidden">'+o+'</span><span class="show">'+t.lat.toFixed(4)+","+t.lng.toFixed(4)+'</span>\x3c!-- TODO:: <a class="btn -link" style="padding: 2px 4px 2px 8px; margin-left: 8px;" onClick=\''+e+'.editLocation($("#current-location>.value").text());return false;\'><i class="icon -material -sg-16">edit</i><span>แก้ไข</span></a> --\x3e</div></div>',c.addMarker({lat:t.lat,lng:t.lng,draggable:"map"!=n.drag,dragend:function(e){p(e.latLng.lat(),e.latLng.lng())}})}n.pin.lat&&n.pin.lng&&(a=f(n.pin),new google.maps.InfoWindow({content:r}).open(c,a));return n.markers&&$.each(n.markers,function(e,t){t.lat&&t.lng&&c.addMarker({lat:t.lat,lng:t.lng,draggable:null!=t.draggable&&t.draggable,icon:null==t.icon?"https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=|CCCCCC|FFFFFF":t.icon,infoWindow:{content:null==t.content?"":t.content}})}),$("#getgis").click(function(){return notify("กำลังหาตำแหน่งปัจจุบัน"),navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){(notify(),c.setCenter({lat:e.coords.latitude,lng:e.coords.longitude}),null==a)&&(a=f({lat:e.coords.latitude,lng:e.coords.longitude,currentLocation:!0}),new google.maps.InfoWindow({content:r}).open(c,a),s=!0);a.setPosition(c.getCenter()),p(e.coords.latitude,e.coords.longitude)},function(){notify("Error: The Geolocation service failed.",5e3)}):notify("Error: Browser doesnt support Geolocation.",5e3),!1}),{clearMap:function(){s=!1,u(""),a.setMap(null)},locationUpdate:u,editLocation:function(e){if(null==l)return!1;console.log("EDIT",e)},currentMarker:function(){return o},settings:n}};